{"version":3,"sources":["../src/context.tsx","../src/styles.ts","../src/constants.ts","../src/utils.ts","../src/SheetBackdrop.tsx","../src/SheetContainer.tsx","../src/hooks/use-drag-constraints.ts","../src/hooks/use-scroll-position.ts","../src/SheetContent.tsx","../src/SheetDragIndicator.tsx","../src/SheetHeader.tsx","../src/hooks/use-isomorphic-layout-effect.ts","../src/hooks/use-dimensions.ts","../src/hooks/use-safe-area-insets.ts","../src/hooks/use-modal-effect.ts","../src/hooks/use-prevent-scroll.ts","../src/hooks/use-stable-callback.ts","../src/hooks/use-sheet-state.ts","../src/hooks/use-virtual-keyboard.ts","../src/snap.ts","../src/sheet.tsx","../src/index.tsx"],"names":["createContext","useContext","styles","forwardRef","motion","React","useRef","useCallback","useState","useEffect","element","isScrollable","useTransform","useLayoutEffect","transform","useMeasure","useMotionValue","useReducedMotion","animate","useImperativeHandle","createPortal","Sheet"],"mappings":";;;;;;;;;;;;;;AAGO,IAAM,YAAA,GAAeA,oBAAA;AAAA,EAC1B;AACF,CAAA;AAEO,SAAS,eAAA,GAAkB;AAChC,EAAA,MAAM,OAAA,GAAUC,kBAAW,YAAY,CAAA;AACvC,EAAA,IAAI,CAAC,OAAA,EAAS,MAAM,IAAI,MAAM,qBAAqB,CAAA;AACnD,EAAA,OAAO,OAAA;AACT;;;ACTO,IAAM,MAAA,GAAS;AAAA,EACpB,IAAA,EAAM;AAAA,IACJ,IAAA,EAAM;AAAA,MACJ,QAAA,EAAU,OAAA;AAAA,MACV,GAAA,EAAK,CAAA;AAAA,MACL,MAAA,EAAQ,CAAA;AAAA,MACR,IAAA,EAAM,CAAA;AAAA,MACN,KAAA,EAAO,CAAA;AAAA,MACP,QAAA,EAAU,QAAA;AAAA,MACV,aAAA,EAAe;AAAA,KACjB;AAAA,IACA,YAAY;AAAC,GACf;AAAA,EACA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM;AAAA,MACJ,MAAA,EAAQ,CAAA;AAAA,MACR,QAAA,EAAU,OAAA;AAAA,MACV,GAAA,EAAK,CAAA;AAAA,MACL,IAAA,EAAM,CAAA;AAAA,MACN,KAAA,EAAO,MAAA;AAAA,MACP,MAAA,EAAQ,MAAA;AAAA,MACR,WAAA,EAAa,MAAA;AAAA,MACb,UAAA,EAAY;AAAA,KACd;AAAA,IACA,UAAA,EAAY;AAAA,MACV,eAAA,EAAiB,oBAAA;AAAA,MACjB,MAAA,EAAQ,MAAA;AAAA,MACR,uBAAA,EAAyB;AAAA;AAC3B,GACF;AAAA,EACA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM;AAAA,MACJ,MAAA,EAAQ,CAAA;AAAA,MACR,QAAA,EAAU,UAAA;AAAA,MACV,IAAA,EAAM,CAAA;AAAA,MACN,MAAA,EAAQ,CAAA;AAAA,MACR,KAAA,EAAO,MAAA;AAAA,MACP,aAAA,EAAe,MAAA;AAAA,MACf,OAAA,EAAS,MAAA;AAAA,MACT,aAAA,EAAe;AAAA,KACjB;AAAA,IACA,UAAA,EAAY;AAAA,MACV,eAAA,EAAiB,MAAA;AAAA,MACjB,oBAAA,EAAsB,KAAA;AAAA,MACtB,mBAAA,EAAqB,KAAA;AAAA,MACrB,SAAA,EAAW;AAAA;AACb,GACF;AAAA,EACA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM;AAAA,MACJ,KAAA,EAAO;AAAA,KACT;AAAA,IACA,YAAY;AAAC,GACf;AAAA,EACA,MAAA,EAAQ;AAAA,IACN,IAAA,EAAM;AAAA,MACJ,KAAA,EAAO,MAAA;AAAA,MACP,QAAA,EAAU;AAAA,KACZ;AAAA,IACA,UAAA,EAAY;AAAA,MACV,MAAA,EAAQ,MAAA;AAAA,MACR,OAAA,EAAS,MAAA;AAAA,MACT,UAAA,EAAY,QAAA;AAAA,MACZ,cAAA,EAAgB;AAAA;AAClB,GACF;AAAA,EACA,gBAAA,EAAkB;AAAA,IAChB,IAAA,EAAM;AAAA,MACJ,OAAA,EAAS;AAAA,KACX;AAAA,IACA,YAAY;AAAC,GACf;AAAA,EACA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM;AAAA,MACJ,OAAA,EAAS;AAAA,KACX;AAAA,IACA,UAAA,EAAY;AAAA,MACV,KAAA,EAAO,MAAA;AAAA,MACP,MAAA,EAAQ,KAAA;AAAA,MACR,YAAA,EAAc,MAAA;AAAA,MACd,eAAA,EAAiB;AAAA;AACnB,GACF;AAAA,EACA,OAAA,EAAS;AAAA,IACP,IAAA,EAAM;AAAA,MACJ,SAAA,EAAW,KAAA;AAAA,MACX,QAAA,EAAU,UAAA;AAAA,MACV,QAAA,EAAU,CAAA;AAAA,MACV,OAAA,EAAS,MAAA;AAAA,MACT,aAAA,EAAe;AAAA,KACjB;AAAA,IACA,YAAY;AAAC,GACf;AAAA,EACA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM;AAAA,MACJ,MAAA,EAAQ,MAAA;AAAA,MACR,SAAA,EAAW,MAAA;AAAA,MACX,mBAAA,EAAqB;AAAA,KACvB;AAAA,IACA,YAAY;AAAC;AAEjB,CAAA;;;ACrGO,IAAM,cAAA,GAAiB,8CAAA;AAEvB,IAAM,MAAA,GAAS,OAAO,MAAA,KAAW,WAAA;AAEjC,IAAM,oBAAA,GAAyC;AAAA,EACpD,IAAA,EAAM,SAAA;AAAA,EACN,QAAA,EAAU;AACZ,CAAA;AAEO,IAAM,2BAAA,GAAgD;AAAA,EAC3D,IAAA,EAAM,QAAA;AAAA,EACN,QAAA,EAAU;AACZ,CAAA;AAEO,IAAM,4BAAA,GAA+B,GAAA;AAErC,IAAM,+BAAA,GAAkC,GAAA;;;ACfxC,SAAS,WAAA,CACdC,SACA,QAAA,EACA;AACA,EAAA,OAAO,QAAA,GAAWA,QAAO,IAAA,GAAO,EAAE,GAAGA,OAAAA,CAAO,IAAA,EAAM,GAAGA,OAAAA,CAAO,UAAA,EAAW;AACzE;AAEO,SAAS,iBAAiB,GAAA,EAAe;AAC9C,EAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,GAAA,CAAI,QAAQ,CAAA,EAAA,EAAK;AACnC,IAAA,IAAI,IAAI,CAAA,GAAI,CAAC,IAAI,GAAA,CAAI,CAAC,GAAG,OAAO,KAAA;AAAA,EAClC;AACA,EAAA,OAAO,IAAA;AACT;AAEO,SAAS,UAAmB,IAAA,EAAyC;AAC1E,EAAA,OAAO,CAAC,KAAA,KAAe;AACrB,IAAA,IAAA,CAAK,OAAA,CAAQ,CAAC,GAAA,KAAa;AACzB,MAAA,IAAI,OAAO,QAAQ,UAAA,EAAY;AAC7B,QAAA,GAAA,CAAI,KAAK,CAAA;AAAA,MACX,WAAW,GAAA,EAAK;AACd,QAAA,GAAA,CAAI,OAAA,GAAU,KAAA;AAAA,MAChB;AAAA,IACF,CAAC,CAAA;AAAA,EACH,CAAA;AACF;AAOA,SAAS,aAAa,EAAA,EAAY;AAlClC,EAAA,IAAA,EAAA;AAmCE,EAAA,OAAO,OAAO,MAAA,KAAW,WAAA,IAAe,MAAA,CAAO,SAAA,IAAa,OACxD,EAAA,CAAG,IAAA;AAAA;AAAA,IAAA,CAAA,CAED,YAAO,SAAA,CAAU,aAAA,KAAjB,IAAA,GAAA,MAAA,GAAA,EAAA,CAAgC,QAAA,KAAY,OAAO,SAAA,CAAU;AAAA,GAC/D,GACA,KAAA;AACN;AAEA,SAAS,OAAO,EAAA,EAAmB;AACjC,EAAA,IAAI,GAAA,GAAsB,IAAA;AAC1B,EAAA,OAAO,MAAM;AACX,IAAA,IAAI,OAAO,IAAA,EAAM;AACf,MAAA,GAAA,GAAM,EAAA,EAAG;AAAA,IACX;AACA,IAAA,OAAO,GAAA;AAAA,EACT,CAAA;AACF;AAEA,IAAM,KAAA,GAAQ,OAAO,WAAY;AAC/B,EAAA,OAAO,aAAa,OAAO,CAAA;AAC7B,CAAC,CAAA;AAED,IAAM,QAAA,GAAW,OAAO,WAAY;AAClC,EAAA,OAAO,aAAa,UAAU,CAAA;AAChC,CAAC,CAAA;AAED,IAAM,MAAA,GAAS,OAAO,WAAY;AAEhC,EAAA,OAAO,aAAa,QAAQ,CAAA,IAAM,KAAA,EAAM,IAAK,UAAU,cAAA,GAAiB,CAAA;AAC1E,CAAC,CAAA;AAEM,IAAM,KAAA,GAAQ,OAAO,WAAY;AACtC,EAAA,OAAO,QAAA,MAAc,MAAA,EAAO;AAC9B,CAAC,CAAA;AAGM,SAAS,cAAA,CACd,SAAA,EACA,QAAA,GAAW,EAAA,EACX,cAAc,EAAA,EACd;AACA,EAAA,OAAO,IAAI,OAAA,CAA4B,CAAC,OAAA,KAAY;AAClD,IAAA,IAAI,QAAA,GAAW,CAAA;AACf,IAAA,MAAM,KAAA,GAAQ,YAAY,MAAM;AAC9B,MAAA,MAAM,UAAU,QAAA,CAAS,sBAAA;AAAA,QACvB;AAAA,QACA,CAAC,CAAA;AACH,MAAA,QAAA,EAAA;AACA,MAAA,IAAI,OAAA,IAAW,YAAY,WAAA,EAAa;AACtC,QAAA,aAAA,CAAc,KAAK,CAAA;AACnB,QAAA,OAAA,CAAQ,OAAO,CAAA;AAAA,MACjB;AAAA,IACF,GAAG,QAAQ,CAAA;AAAA,EACb,CAAC,CAAA;AACH;;;ACjFA,IAAM,WAAA,GAAc,CAAC,KAAA,KAAe,CAAC,CAAC,KAAA,CAAM,OAAA,IAAW,CAAC,CAAC,KAAA,CAAM,KAAA;AAExD,IAAM,aAAA,GAAgBC,iBAAA;AAAA,EAC3B,CAAC,EAAE,KAAA,EAAO,SAAA,GAAY,IAAI,QAAA,EAAU,GAAG,IAAA,EAAK,EAAG,GAAA,KAAQ;AACrD,IAAA,MAAM,eAAe,eAAA,EAAgB;AACrC,IAAA,MAAM,SAAA,GAAY,YAAY,IAAI,CAAA;AAClC,IAAA,MAAM,IAAA,GAAO,SAAA,GAAYC,YAAA,CAAO,MAAA,GAASA,YAAA,CAAO,GAAA;AAChD,IAAA,MAAM,aAAA,GAAgB,YAAY,MAAA,GAAS,MAAA;AAE3C,IAAA,MAAM,UAAA,GAAa,YAAY,YAAA,CAAa,QAAA;AAE5C,IAAA,MAAM,aAAA,GAA6B;AAAA,MACjC,GAAG,WAAA,CAAY,MAAA,CAAO,QAAA,EAAU,UAAU,CAAA;AAAA,MAC1C,GAAG,KAAA;AAAA,MACH;AAAA,KACF;AAEA,IAAA,uBACEC,uBAAA,CAAA,aAAA;AAAA,MAAC,IAAA;AAAA,MAAA;AAAA,QACE,GAAI,IAAA;AAAA,QACL,GAAA;AAAA,QACA,SAAA,EAAW,8BAA8B,SAAS,CAAA,CAAA;AAAA,QAClD,KAAA,EAAO,aAAA;AAAA,QACP,OAAA,EAAS,EAAE,OAAA,EAAS,CAAA,EAAE;AAAA,QACtB,OAAA,EAAS,EAAE,OAAA,EAAS,CAAA,EAAE;AAAA,QACtB,IAAA,EAAM,EAAE,OAAA,EAAS,CAAA,EAAE;AAAA,QACnB,UAAA,EAAY,EAAE,QAAA,EAAU,CAAA;AAAE;AAAA,KAC5B;AAAA,EAEJ;AACF,CAAA;AAEA,aAAA,CAAc,WAAA,GAAc,eAAA;AC/BrB,IAAM,cAAA,GAAiBF,iBAAAA;AAAA,EAC5B,CAAC,EAAE,QAAA,EAAU,KAAA,EAAO,SAAA,GAAY,IAAI,QAAA,EAAU,GAAG,IAAA,EAAK,EAAG,GAAA,KAAQ;AAC/D,IAAA,MAAM,eAAe,eAAA,EAAgB;AAErC,IAAA,MAAM,UAAA,GAAa,YAAY,YAAA,CAAa,QAAA;AAE5C,IAAA,MAAM,cAAA,GAA8B;AAAA,MAClC,GAAG,WAAA,CAAY,MAAA,CAAO,SAAA,EAAW,UAAU,CAAA;AAAA,MAC3C,GAAG,KAAA;AAAA,MACH,GAAG,YAAA,CAAa;AAAA,KAClB;AAEA,IAAA,IAAI,YAAA,CAAa,WAAW,SAAA,EAAW;AACrC,MAAA,cAAA,CAAe,MAAA,GAAS,cAAA;AAAA,IAC1B;AAEA,IAAA,IAAI,YAAA,CAAa,WAAW,MAAA,EAAQ;AAClC,MAAA,cAAA,CAAe,MAAA,GAAS,MAAA;AACxB,MAAA,cAAA,CAAe,SAAA,GAAY,MAAA;AAAA,IAC7B;AAEA,IAAA,IAAI,YAAA,CAAa,WAAW,SAAA,EAAW;AACrC,MAAA,cAAA,CAAe,MAAA,GAAS,MAAA;AACxB,MAAA,cAAA,CAAe,SAAA,GAAY,cAAA;AAAA,IAC7B;AAEA,IAAA,uBACEE,uBAAAA,CAAA,aAAA;AAAA,MAACD,YAAAA,CAAO,GAAA;AAAA,MAAP;AAAA,QACE,GAAG,IAAA;AAAA,QACJ,KAAK,SAAA,CAAU;AAAA,UACb,GAAA;AAAA,UACA,YAAA,CAAa,QAAA;AAAA,UACb,YAAA,CAAa;AAAA,SACd,CAAA;AAAA,QACD,SAAA,EAAW,+BAA+B,SAAS,CAAA,CAAA;AAAA,QACnD,KAAA,EAAO;AAAA,OAAA;AAAA,MAEN;AAAA,KACH;AAAA,EAEJ;AACF,CAAA;AAEA,cAAA,CAAe,WAAA,GAAc,gBAAA;AC7C7B,IAAM,WAAA,GAA2B,EAAE,MAAA,EAAQ,CAAA,EAAG,KAAK,CAAA,EAAG,IAAA,EAAM,CAAA,EAAG,KAAA,EAAO,CAAA,EAAE;AAEjE,SAAS,kBAAA,GAAqB;AACnC,EAAA,MAAM,GAAA,GAAME,cAAY,IAAI,CAAA;AAC5B,EAAA,MAAM,SAAA,GAAYC,kBAAA,CAAY,MAAM,WAAA,EAAa,EAAE,CAAA;AACnD,EAAA,OAAO,EAAE,KAAK,SAAA,EAAU;AAC1B;ACgCO,SAAS,iBAAA,CAAkB,OAAA,GAAoC,EAAC,EAAG;AACxE,EAAA,MAAM,EAAE,aAAA,GAAgB,EAAA,EAAI,SAAA,GAAY,MAAK,GAAI,OAAA;AAEjD,EAAA,MAAM,CAAC,OAAA,EAAS,UAAU,CAAA,GAAIC,gBAA6B,IAAI,CAAA;AAC/D,EAAA,MAAM,CAAC,cAAA,EAAgB,iBAAiB,CAAA,GAAIA,gBAE1C,MAAS,CAAA;AAEX,EAAAC,gBAAA,CAAU,MAAM;AACd,IAAA,IAAI,CAAC,OAAA,IAAW,CAAC,SAAA,EAAW;AAE5B,IAAA,IAAI,aAAA,GAA+B,IAAA;AAEnC,IAAA,SAAS,wBAAwBC,QAAAA,EAAsB;AACrD,MAAA,MAAM,EAAE,SAAA,EAAW,YAAA,EAAc,YAAA,EAAa,GAAIA,QAAAA;AAClD,MAAA,MAAMC,gBAAe,YAAA,GAAe,YAAA;AAEpC,MAAA,IAAI,CAACA,aAAAA,EAAc;AAEjB,QAAA,IAAI,cAAA,oBAAkC,MAAS,CAAA;AAC/C,QAAA;AAAA,MACF;AAEA,MAAA,MAAM,UAAU,SAAA,IAAa,CAAA;AAC7B,MAAA,MAAM,UAAA,GACJ,IAAA,CAAK,IAAA,CAAK,YAAY,CAAA,GAAI,IAAA,CAAK,IAAA,CAAK,SAAS,CAAA,KAC7C,IAAA,CAAK,IAAA,CAAK,YAAY,CAAA;AAExB,MAAA,IAAI,QAAA;AAEJ,MAAA,IAAI,OAAA,EAAS;AACX,QAAA,QAAA,GAAW,KAAA;AAAA,MACb,WAAW,UAAA,EAAY;AACrB,QAAA,QAAA,GAAW,QAAA;AAAA,MACb,CAAA,MAAO;AACL,QAAA,QAAA,GAAW,QAAA;AAAA,MACb;AAEA,MAAA,IAAI,aAAa,cAAA,EAAgB;AACjC,MAAA,iBAAA,CAAkB,QAAQ,CAAA;AAAA,IAC5B;AAEA,IAAA,SAAS,SAAS,KAAA,EAAc;AAC9B,MAAA,IAAI,KAAA,CAAM,yBAAyB,WAAA,EAAa;AAC9C,QAAA,MAAM,KAAK,KAAA,CAAM,aAAA;AAEjB,QAAA,IAAI,aAAA,eAA4B,aAAa,CAAA;AAE7C,QAAA,IAAI,kBAAkB,CAAA,EAAG;AACvB,UAAA,uBAAA,CAAwB,EAAE,CAAA;AAAA,QAC5B,CAAA,MAAO;AAEL,UAAA,aAAA,GAAgB,UAAA;AAAA,YACd,MAAM,wBAAwB,EAAE,CAAA;AAAA,YAChC;AAAA,WACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAEA,IAAA,SAAS,aAAa,KAAA,EAAc;AAClC,MAAA,IAAI,KAAA,CAAM,yBAAyB,WAAA,EAAa;AAC9C,QAAA,uBAAA,CAAwB,MAAM,aAAa,CAAA;AAAA,MAC7C;AAAA,IACF;AAGA,IAAA,uBAAA,CAAwB,OAAO,CAAA;AAE/B,IAAA,OAAA,CAAQ,gBAAA,CAAiB,UAAU,QAAQ,CAAA;AAC3C,IAAA,OAAA,CAAQ,gBAAA,CAAiB,cAAc,YAAY,CAAA;AAEnD,IAAA,OAAO,MAAM;AACX,MAAA,IAAI,aAAA,eAA4B,aAAa,CAAA;AAC7C,MAAA,OAAA,CAAQ,mBAAA,CAAoB,UAAU,QAAQ,CAAA;AAC9C,MAAA,OAAA,CAAQ,mBAAA,CAAoB,cAAc,YAAY,CAAA;AAAA,IACxD,CAAA;AAAA,EACF,CAAA,EAAG,CAAC,OAAA,EAAS,SAAS,CAAC,CAAA;AAEvB,EAAA,OAAO;AAAA,IACL,SAAA,EAAW,CAACD,QAAAA,KAAgC,UAAA,CAAWA,QAAO,CAAA;AAAA,IAC9D;AAAA,GACF;AACF;;;ACtHO,IAAM,YAAA,GAAeP,iBAAAA;AAAA,EAC1B,CACE;AAAA,IACE,aAAA,EAAe,iBAAA;AAAA,IACf,WAAA,EAAa,eAAA;AAAA,IACb,QAAA;AAAA,IACA,KAAA,EAAO,SAAA;AAAA,IACP,SAAA,GAAY,EAAA;AAAA,IACZ,eAAA,GAAkB,EAAA;AAAA,IAClB,WAAA,EAAa,eAAA;AAAA,IACb,WAAW,aAAA,GAAgB,IAAA;AAAA,IAC3B,QAAA;AAAA,IACA,GAAG;AAAA,KAEL,GAAA,KACG;AACH,IAAA,MAAM,eAAe,eAAA,EAAgB;AACrC,IAAA,MAAM,kBAAkB,kBAAA,EAAmB;AAC3C,IAAA,MAAM,SAAS,iBAAA,EAAkB;AAEjC,IAAA,MAAM,aAAA,GACJ,OAAO,iBAAA,KAAsB,UAAA,GACzB,iBAAA,CAAkB;AAAA,MAChB,gBAAgB,MAAA,CAAO,cAAA;AAAA,MACvB,aAAa,YAAA,CAAa;AAAA,KAC3B,CAAA,GACD,OAAA,CAAQ,iBAAiB,CAAA;AAE/B,IAAA,MAAM,yBACJ,CAAC,aAAA,IACD,MAAA,CAAO,cAAA,IACP,OAAO,cAAA,KAAmB,KAAA;AAE5B,IAAA,MAAM,oBAAA,GACJ,OAAO,eAAA,KAAoB,UAAA,GACvB,eAAA,CAAgB;AAAA,MACd,gBAAgB,MAAA,CAAO,cAAA;AAAA,MACvB,aAAa,YAAA,CAAa;AAAA,KAC3B,CAAA,GACD,OAAA,CAAQ,eAAe,CAAA;AAE7B,IAAA,MAAM,WAAA,GACJ,oBAAA,IACA,sBAAA,IACA,YAAA,CAAa,WAAA;AAEf,IAAA,MAAM,SAAA,GACJ,WAAA,IAAe,YAAA,CAAa,WAAA,GACxB,SACA,YAAA,CAAa,SAAA;AAEnB,IAAA,MAAM,UAAA,GAAa,YAAY,YAAA,CAAa,QAAA;AAE5C,IAAA,MAAM,YAAA,GAA4B;AAAA,MAChC,GAAG,WAAA,CAAY,MAAA,CAAO,OAAA,EAAS,UAAU,CAAA;AAAA,MACzC,GAAG;AAAA,KACL;AAEA,IAAA,MAAM,WAAA,GAA2B,WAAA,CAAY,MAAA,CAAO,QAAA,EAAU,UAAU,CAAA;AAExE,IAAA,IAAI,aAAa,aAAA,EAAe;AAC9B,MAAA,WAAA,CAAY,aAAA,GACV,+DAAA;AAAA,IACJ;AAEA,IAAA,IAAI,aAAA,EAAe;AACjB,MAAA,WAAA,CAAY,SAAA,GAAY,QAAA;AAAA,IAC1B;AAEA,IAAA,uBACEE,uBAAAA,CAAA,aAAA;AAAA,MAACD,YAAAA,CAAO,GAAA;AAAA,MAAP;AAAA,QACE,GAAG,IAAA;AAAA,QACJ,KAAK,SAAA,CAAU,CAAC,GAAA,EAAK,eAAA,CAAgB,GAAG,CAAC,CAAA;AAAA,QACzC,SAAA,EAAW,6BAA6B,SAAS,CAAA,CAAA;AAAA,QACjD,KAAA,EAAO,YAAA;AAAA,QACN,GAAG,SAAA;AAAA,QACJ,iBAAiB,eAAA,CAAgB,GAAA;AAAA,QACjC,0BAA0B,eAAA,CAAgB;AAAA,OAAA;AAAA,sBAE1CC,uBAAAA,CAAA,aAAA;AAAA,QAACD,YAAAA,CAAO,GAAA;AAAA,QAAP;AAAA,UACC,KAAK,SAAA,CAAU,CAAC,MAAA,CAAO,SAAA,EAAW,aAAa,CAAC,CAAA;AAAA,UAChD,KAAA,EAAO,EAAE,GAAG,WAAA,EAAa,GAAG,eAAA,EAAgB;AAAA,UAC5C,SAAA,EAAW,sCAAsC,eAAe,CAAA;AAAA,SAAA;AAAA,QAE/D;AAAA;AACH,KACF;AAAA,EAEJ;AACF,CAAA;AAEA,YAAA,CAAa,WAAA,GAAc,cAAA;AC7FpB,SAAS,kBAAA,CAAmB;AAAA,EACjC,KAAA;AAAA,EACA,SAAA,GAAY,EAAA;AAAA,EACZ,QAAA;AAAA,EACA,GAAG;AACL,CAAA,EAA4B;AAC1B,EAAA,MAAM,eAAe,eAAA,EAAgB;AAErC,EAAA,MAAM,mBAAA,GAAsBQ,kBAAA;AAAA,IAC1B,YAAA,CAAa,iBAAA;AAAA,IACb,CAAC,CAAA,KAAM,CAAA,uBAAA,EAA0B,CAAC,CAAA,IAAA;AAAA,GACpC;AAEA,EAAA,MAAM,mBAAA,GAAsBA,kBAAA;AAAA,IAC1B,YAAA,CAAa,iBAAA;AAAA,IACb,CAAC,CAAA,KAAM,CAAA,wBAAA,EAA2B,GAAA,GAAK,CAAC,CAAA,IAAA;AAAA,GAC1C;AAEA,EAAA,MAAM,UAAA,GAAa,YAAY,YAAA,CAAa,QAAA;AAE5C,EAAA,MAAM,qBAAA,GAAwB;AAAA,IAC5B,GAAG,WAAA,CAAY,MAAA,CAAO,gBAAA,EAAkB,UAAU,CAAA;AAAA,IAClD,GAAG;AAAA,GACL;AAEA,EAAA,MAAM,cAAA,GAAiB,WAAA,CAAY,MAAA,CAAO,SAAA,EAAW,UAAU,CAAA;AAE/D,EAAA,uBACEP,uBAAAA,CAAA,aAAA;AAAA,IAAC,KAAA;AAAA,IAAA;AAAA,MACC,SAAA,EAAW,8CAA8C,SAAS,CAAA,CAAA;AAAA,MAClE,KAAA,EAAO,qBAAA;AAAA,MACN,GAAG;AAAA,KAAA;AAAA,oBAEJA,uBAAAA,CAAA,aAAA;AAAA,MAACD,YAAAA,CAAO,IAAA;AAAA,MAAP;AAAA,QACC,SAAA,EAAU,kCAAA;AAAA,QACV,KAAA,EAAO,EAAE,GAAG,cAAA,EAAgB,WAAW,mBAAA;AAAoB;AAAA,KAC7D;AAAA,oBACAC,uBAAAA,CAAA,aAAA;AAAA,MAACD,YAAAA,CAAO,IAAA;AAAA,MAAP;AAAA,QACC,SAAA,EAAU,kCAAA;AAAA,QACV,KAAA,EAAO,EAAE,GAAG,cAAA,EAAgB,WAAW,mBAAA;AAAoB;AAAA;AAC7D,GACF;AAEJ;ACzCO,IAAM,WAAA,GAAcD,iBAAAA;AAAA,EACzB,CACE,EAAE,QAAA,EAAU,KAAA,EAAO,WAAA,EAAa,QAAA,EAAU,SAAA,GAAY,EAAA,EAAI,GAAG,IAAA,EAAK,EAClE,GAAA,KACG;AACH,IAAA,MAAM,eAAe,eAAA,EAAgB;AACrC,IAAA,MAAM,kBAAkB,kBAAA,EAAmB;AAC3C,IAAA,MAAM,SAAA,GACJ,WAAA,IAAe,YAAA,CAAa,WAAA,GACxB,SACA,YAAA,CAAa,SAAA;AAEnB,IAAA,MAAM,UAAA,GAAa,YAAY,YAAA,CAAa,QAAA;AAE5C,IAAA,MAAM,kBAAA,GAAqB;AAAA,MACzB,GAAG,WAAA,CAAY,MAAA,CAAO,aAAA,EAAe,UAAU,CAAA;AAAA,MAC/C,GAAG;AAAA,KACL;AAEA,IAAA,MAAM,WAAA,GAAc,WAAA,CAAY,MAAA,CAAO,MAAA,EAAQ,UAAU,CAAA;AAEzD,IAAA,uBACEE,uBAAAA,CAAA,aAAA;AAAA,MAACD,YAAAA,CAAO,GAAA;AAAA,MAAP;AAAA,QACE,GAAG,IAAA;AAAA,QACJ,KAAK,SAAA,CAAU,CAAC,GAAA,EAAK,eAAA,CAAgB,GAAG,CAAC,CAAA;AAAA,QACzC,KAAA,EAAO,kBAAA;AAAA,QACP,SAAA,EAAW,sCAAsC,SAAS,CAAA,CAAA;AAAA,QACzD,GAAG,SAAA;AAAA,QACJ,iBAAiB,eAAA,CAAgB,GAAA;AAAA,QACjC,0BAA0B,eAAA,CAAgB;AAAA,OAAA;AAAA,MAEzC,QAAA,oBACCC,uBAAAA,CAAA,aAAA,CAAC,KAAA,EAAA,EAAI,SAAA,EAAU,0BAAA,EAA2B,KAAA,EAAO,WAAA,EAAA,kBAC/CA,uBAAAA,CAAA,aAAA,CAAC,wBAAmB,CACtB;AAAA,KAEJ;AAAA,EAEJ;AACF,CAAA;AAEA,WAAA,CAAY,WAAA,GAAc,aAAA;AC/CnB,IAAM,yBAAA,GAA4B,SAASI,gBAAAA,GAAYI,sBAAA;;;ACCvD,SAAS,aAAA,GAAgB;AAC9B,EAAA,MAAM,CAAC,UAAA,EAAY,aAAa,CAAA,GAAIL,gBAAS,OAAO;AAAA,IAClD,YAAA,EAAc,CAAC,MAAA,GAAS,MAAA,CAAO,WAAA,GAAc,CAAA;AAAA,IAC7C,WAAA,EAAa,CAAC,MAAA,GAAS,MAAA,CAAO,UAAA,GAAa;AAAA,GAC7C,CAAE,CAAA;AAEF,EAAA,yBAAA,CAA0B,MAAM;AAC9B,IAAA,SAAS,OAAA,GAAU;AACjB,MAAA,aAAA,CAAc;AAAA,QACZ,cAAc,MAAA,CAAO,WAAA;AAAA,QACrB,aAAa,MAAA,CAAO;AAAA,OACrB,CAAA;AAAA,IACH;AAEA,IAAA,OAAA,EAAQ;AAER,IAAA,MAAA,CAAO,gBAAA,CAAiB,UAAU,OAAO,CAAA;AAEzC,IAAA,OAAO,MAAM;AACX,MAAA,MAAA,CAAO,mBAAA,CAAoB,UAAU,OAAO,CAAA;AAAA,IAC9C,CAAA;AAAA,EACF,CAAA,EAAG,EAAE,CAAA;AAEL,EAAA,OAAO,UAAA;AACT;ACzBO,SAAS,iBAAA,GAAoB;AAClC,EAAA,MAAM,CAAC,MAAM,CAAA,GAAIA,eAAAA,CAAS,MAAM;AAC9B,IAAA,MAAM,QAAA,GAAW,EAAE,GAAA,EAAK,CAAA,EAAG,MAAM,CAAA,EAAG,KAAA,EAAO,CAAA,EAAG,MAAA,EAAQ,CAAA,EAAE;AAExD,IAAA,IAAI,QAAQ,OAAO,QAAA;AAEnB,IAAA,MAAM,IAAA,GAAO,QAAA,CAAS,aAAA,CAA2B,OAAO,CAAA;AAExD,IAAA,IAAI,CAAC,MAAM,OAAO,QAAA;AAElB,IAAA,IAAA,CAAK,KAAA,CAAM,WAAA,CAAY,WAAA,EAAa,0BAA0B,CAAA;AAC9D,IAAA,IAAA,CAAK,KAAA,CAAM,WAAA,CAAY,WAAA,EAAa,2BAA2B,CAAA;AAC/D,IAAA,IAAA,CAAK,KAAA,CAAM,WAAA,CAAY,WAAA,EAAa,4BAA4B,CAAA;AAChE,IAAA,IAAA,CAAK,KAAA,CAAM,WAAA,CAAY,WAAA,EAAa,6BAA6B,CAAA;AAEjE,IAAA,MAAM,aAAA,GAAgB,iBAAiB,IAAI,CAAA;AAC3C,IAAA,MAAM,GAAA,GAAM,gBAAA,CAAiB,aAAA,EAAe,WAAW,CAAA;AACvD,IAAA,MAAM,GAAA,GAAM,gBAAA,CAAiB,aAAA,EAAe,WAAW,CAAA;AACvD,IAAA,MAAM,GAAA,GAAM,gBAAA,CAAiB,aAAA,EAAe,WAAW,CAAA;AACvD,IAAA,MAAM,GAAA,GAAM,gBAAA,CAAiB,aAAA,EAAe,WAAW,CAAA;AAEvD,IAAA,IAAA,CAAK,KAAA,CAAM,eAAe,WAAW,CAAA;AACrC,IAAA,IAAA,CAAK,KAAA,CAAM,eAAe,WAAW,CAAA;AACrC,IAAA,IAAA,CAAK,KAAA,CAAM,eAAe,WAAW,CAAA;AACrC,IAAA,IAAA,CAAK,KAAA,CAAM,eAAe,WAAW,CAAA;AAErC,IAAA,OAAO,EAAE,KAAK,GAAA,EAAK,IAAA,EAAM,KAAK,KAAA,EAAO,GAAA,EAAK,QAAQ,GAAA,EAAI;AAAA,EACxD,CAAC,CAAA;AAED,EAAA,OAAO,MAAA;AACT;AAEA,SAAS,gBAAA,CAAiB,UAA+B,QAAA,EAAkB;AACzE,EAAA,MAAM,QAAA,GAAW,SAAS,gBAAA,CAAiB,QAAQ,EAAE,OAAA,CAAQ,IAAA,EAAM,EAAE,CAAA,CAAE,IAAA,EAAK;AAC5E,EAAA,OAAO,QAAA,CAAS,QAAA,EAAU,EAAE,CAAA,IAAK,CAAA;AACnC;;;AChCO,SAAS,cAAA,CAAe;AAAA,EAC7B,CAAA;AAAA,EACA,MAAA;AAAA,EACA,MAAA,EAAQ,OAAA;AAAA,EACR,WAAA;AAAA,EACA,UAAA;AAAA,EACA;AACF,CAAA,EAOG;AACD,EAAA,MAAM,QAAA,GAAW,mBAAkB,CAAE,GAAA;AAErC,EAAA,IAAI,MAAA,GAA6B,OAAA;AAEjC,EAAA,IAAI,MAAA,IAAU,WAAW,MAAA,EAAQ;AAC/B,IAAA,OAAA,CAAQ,KAAK,yDAAyD,CAAA;AACtE,IAAA,MAAA,GAAS,MAAA;AAAA,EACX;AAGA,EAAA,yBAAA,CAA0B,MAAM;AAC9B,IAAA,OAAO,MAAM;AACX,MAAA,IAAI,MAAA,qBAA2B,MAAM,CAAA;AAAA,IACvC,CAAA;AAAA,EACF,CAAA,EAAG,EAAE,CAAA;AAEL,EAAA,yBAAA,CAA0B,MAAM;AAC9B,IAAA,IAAI,CAAC,MAAA,EAAQ;AAEb,IAAA,MAAM,IAAA,GAAO,QAAA,CAAS,aAAA,CAAc,CAAA,CAAA,EAAI,MAAM,CAAA,CAAE,CAAA;AAChD,IAAA,IAAI,CAAC,IAAA,EAAM;AAEX,IAAA,MAAM,mBAAA,GAAsB,CAAA,CAAE,EAAA,CAAG,gBAAA,EAAkB,MAAM;AAEvD,MAAA,gBAAA,CAAiB,MAAO,CAAA;AAAA,IAC1B,CAAC,CAAA;AAMD,IAAA,MAAM,oBAAA,GAAuB,CAAA,CAAE,EAAA,CAAG,QAAA,EAAU,CAAC,MAAA,KAAW;AACtD,MAAA,IAAI,CAAC,IAAA,EAAM;AAEX,MAAA,IAAI,WAAW,IAAA,CAAK,GAAA,CAAI,CAAA,EAAG,CAAA,GAAI,SAAS,WAAW,CAAA;AAOnD,MAAA,MAAM,kBAAA,GACJ,WAAW,MAAA,GAAS,CAAA,GAAI,WAAW,UAAA,CAAW,MAAA,GAAS,CAAC,CAAA,GAAI,MAAA;AAQ9D,MAAA,IAAI,uBAAuB,MAAA,EAAW;AACpC,QAAA,MAAM,qBAAqB,kBAAA,CAAmB,UAAA;AAE9C,QAAA,IAAI,UAAU,kBAAA,EAAoB;AAChC,UAAA,QAAA,GAAA,CAAY,qBAAqB,MAAA,IAAU,kBAAA;AAAA,QAC7C,CAAA,MAAO;AACL,UAAA,QAAA,GAAW,CAAA;AAAA,QACb;AAAA,MACF;AAQA,MAAA,IAAI,mBAAmB,MAAA,EAAW;AAChC,QAAA,MAAM,mBAAA,GACJ,cACA,IAAA,CAAK,GAAA,CAAI,KAAK,KAAA,CAAM,cAAA,GAAiB,WAAW,CAAA,EAAG,WAAW,CAAA;AAEhE,QAAA,IAAI,UAAU,mBAAA,EAAqB;AACjC,UAAA,QAAA,GAAA,CAAY,sBAAsB,MAAA,IAAU,mBAAA;AAAA,QAC9C,CAAA,MAAO;AACL,UAAA,QAAA,GAAW,CAAA;AAAA,QACb;AAAA,MACF;AAGA,MAAA,QAAA,GAAW,KAAK,GAAA,CAAI,CAAA,EAAG,KAAK,GAAA,CAAI,CAAA,EAAG,QAAQ,CAAC,CAAA;AAE5C,MAAA,MAAM,YAAY,MAAA,CAAO,UAAA;AACzB,MAAA,MAAM,EAAA,GAAKM,gBAAA,CAAU,QAAA,EAAU,CAAC,CAAA,EAAG,CAAC,CAAA,EAAG,CAAC,CAAA,EAAG,EAAA,GAAK,QAAQ,CAAC,CAAA;AACzD,MAAA,MAAM,CAAA,GAAIA,gBAAA,CAAU,QAAA,EAAU,CAAC,CAAA,EAAG,CAAC,CAAA,EAAG,CAAC,CAAA,EAAA,CAAI,SAAA,GAAY,EAAA,IAAM,SAAS,CAAC,CAAA;AACvE,MAAA,MAAM,YAAA,GAAeA,gBAAA,CAAU,QAAA,EAAU,CAAC,CAAA,EAAG,CAAC,CAAA,EAAG,CAAC,CAAA,EAAG,EAAE,CAAC,CAAA;AAExD,MAAA,IAAA,CAAK,KAAA,CAAM,SAAA,GAAY,CAAA,MAAA,EAAS,CAAC,oBAAoB,EAAE,CAAA,MAAA,CAAA;AACvD,MAAA,IAAA,CAAK,KAAA,CAAM,oBAAA,GAAuB,CAAA,EAAG,YAAY,CAAA,EAAA,CAAA;AACjD,MAAA,IAAA,CAAK,KAAA,CAAM,mBAAA,GAAsB,CAAA,EAAG,YAAY,CAAA,EAAA,CAAA;AAAA,IAClD,CAAC,CAAA;AAED,IAAA,SAAS,WAAA,GAAc;AAErB,MAAA,IAAI,CAAA,CAAE,GAAA,EAAI,GAAI,CAAA,IAAK,WAAA,EAAa;AAE9B,QAAA,kBAAA,CAAmB,MAAO,CAAA;AAAA,MAC5B;AAAA,IACF;AAEA,IAAA,MAAM,sBAAA,GAAyB,CAAA,CAAE,EAAA,CAAG,mBAAA,EAAqB,WAAW,CAAA;AACpE,IAAA,MAAM,oBAAA,GAAuB,CAAA,CAAE,EAAA,CAAG,iBAAA,EAAmB,WAAW,CAAA;AAEhE,IAAA,OAAO,MAAM;AACX,MAAA,mBAAA,EAAoB;AACpB,MAAA,oBAAA,EAAqB;AACrB,MAAA,sBAAA,EAAuB;AACvB,MAAA,oBAAA,EAAqB;AAAA,IACvB,CAAA;AAAA,EACF,GAAG,CAAC,CAAA,EAAG,QAAQ,QAAA,EAAU,cAAA,EAAgB,WAAW,CAAC,CAAA;AACvD;AAEA,SAAS,iBAAiB,MAAA,EAAgB;AACxC,EAAA,MAAM,IAAA,GAAO,QAAA,CAAS,aAAA,CAAc,CAAA,CAAA,EAAI,MAAM,CAAA,CAAE,CAAA;AAChD,EAAA,MAAM,IAAA,GAAO,QAAA,CAAS,aAAA,CAAc,MAAM,CAAA;AAC1C,EAAA,IAAI,CAAC,IAAA,EAAM;AAEX,EAAA,IAAA,CAAK,MAAM,eAAA,GAAkB,MAAA;AAC7B,EAAA,IAAA,CAAK,MAAM,QAAA,GAAW,QAAA;AACtB,EAAA,IAAA,CAAK,MAAM,wBAAA,GAA2B,gCAAA;AACtC,EAAA,IAAA,CAAK,MAAM,kBAAA,GAAqB,0BAAA;AAChC,EAAA,IAAA,CAAK,MAAM,kBAAA,GAAqB,MAAA;AAChC,EAAA,IAAA,CAAK,MAAM,eAAA,GAAkB,YAAA;AAC/B;AAEA,SAAS,mBAAmB,MAAA,EAAgB;AAC1C,EAAA,MAAM,IAAA,GAAO,QAAA,CAAS,aAAA,CAAc,CAAA,CAAA,EAAI,MAAM,CAAA,CAAE,CAAA;AAChD,EAAA,MAAM,IAAA,GAAO,QAAA,CAAS,aAAA,CAAc,MAAM,CAAA;AAC1C,EAAA,IAAI,CAAC,IAAA,EAAM;AAEX,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,kBAAkB,CAAA;AAC5C,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,UAAU,CAAA;AACpC,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,4BAA4B,CAAA;AACtD,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,qBAAqB,CAAA;AAC/C,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,qBAAqB,CAAA;AAC/C,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,kBAAkB,CAAA;AAC5C,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,WAAW,CAAA;AACrC,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,yBAAyB,CAAA;AACnD,EAAA,IAAA,CAAK,KAAA,CAAM,eAAe,wBAAwB,CAAA;AACpD;;;AC3JA,IAAM,eAAA,GAAkB,EAAA;AAOxB,SAAS,SAAS,SAAA,EAA4C;AAC5D,EAAA,OAAO,IAAI,IAAA,KAAgB;AACzB,IAAA,KAAA,MAAW,YAAY,SAAA,EAAW;AAChC,MAAA,IAAI,OAAO,aAAa,UAAA,EAAY;AAClC,QAAA,QAAA,CAAS,GAAG,IAAI,CAAA;AAAA,MAClB;AAAA,IACF;AAAA,EACF,CAAA;AACF;AAEA,IAAM,cAAA,GAAiB,OAAO,QAAA,KAAa,WAAA,IAAe,MAAA,CAAO,cAAA;AAE1D,SAAS,YAAA,CACd,MACA,gBAAA,EACS;AACT,EAAA,IAAI,CAAC,IAAA,EAAM;AACT,IAAA,OAAO,KAAA;AAAA,EACT;AAEA,EAAA,MAAM,KAAA,GAAQ,MAAA,CAAO,gBAAA,CAAiB,IAAI,CAAA;AAE1C,EAAA,IAAIH,gBAAe,eAAA,CAAgB,IAAA;AAAA,IACjC,KAAA,CAAM,QAAA,GAAW,KAAA,CAAM,SAAA,GAAY,KAAA,CAAM;AAAA,GAC3C;AAEA,EAAA,IAAIA,iBAAgB,gBAAA,EAAkB;AACpC,IAAAA,gBACE,IAAA,CAAK,YAAA,KAAiB,KAAK,YAAA,IAC3B,IAAA,CAAK,gBAAgB,IAAA,CAAK,WAAA;AAAA,EAC9B;AAEA,EAAA,OAAOA,aAAAA;AACT;AAEO,SAAS,eAAA,CACd,MACA,gBAAA,EACS;AACT,EAAA,IAAI,cAAA,GAAiC,IAAA;AAErC,EAAA,IAAI,YAAA,CAAa,cAAA,EAAgB,gBAAgB,CAAA,EAAG;AAClD,IAAA,cAAA,GAAiB,cAAA,CAAe,aAAA;AAAA,EAClC;AAEA,EAAA,OAAO,cAAA,IAAkB,CAAC,YAAA,CAAa,cAAA,EAAgB,gBAAgB,CAAA,EAAG;AACxE,IAAA,cAAA,GAAiB,cAAA,CAAe,aAAA;AAAA,EAClC;AAEA,EAAA,OACE,cAAA,IAAkB,QAAA,CAAS,gBAAA,IAAoB,QAAA,CAAS,eAAA;AAE5D;AAGA,IAAM,iBAAA,uBAAwB,GAAA,CAAI;AAAA,EAChC,UAAA;AAAA,EACA,OAAA;AAAA,EACA,OAAA;AAAA,EACA,OAAA;AAAA,EACA,MAAA;AAAA,EACA,OAAA;AAAA,EACA,QAAA;AAAA,EACA,QAAA;AAAA,EACA;AACF,CAAC,CAAA;AAGD,IAAI,kBAAA,GAAqB,CAAA;AACzB,IAAI,OAAA;AAOG,SAAS,gBAAA,CAAiB,OAAA,GAAgC,EAAC,EAAG;AACnE,EAAA,MAAM,EAAE,YAAW,GAAI,OAAA;AAEvB,EAAA,yBAAA,CAA0B,MAAM;AAC9B,IAAA,IAAI,UAAA,EAAY;AACd,MAAA;AAAA,IACF;AAEA,IAAA,kBAAA,EAAA;AACA,IAAA,IAAI,uBAAuB,CAAA,EAAG;AAC5B,MAAA,IAAI,OAAM,EAAG;AACX,QAAA,OAAA,GAAU,yBAAA,EAA0B;AAAA,MACtC,CAAA,MAAO;AACL,QAAA,OAAA,GAAU,qBAAA,EAAsB;AAAA,MAClC;AAAA,IACF;AAEA,IAAA,OAAO,MAAM;AACX,MAAA,kBAAA,EAAA;AACA,MAAA,IAAI,uBAAuB,CAAA,EAAG;AAC5B,QAAA,OAAA,IAAA,IAAA,GAAA,MAAA,GAAA,OAAA,EAAA;AAAA,MACF;AAAA,IACF,CAAA;AAAA,EACF,CAAA,EAAG,CAAC,UAAU,CAAC,CAAA;AACjB;AAIA,SAAS,qBAAA,GAAwB;AAC/B,EAAA,OAAO,KAAA;AAAA,IACL,QAAA;AAAA,MACE,QAAA,CAAS,eAAA;AAAA,MACT,cAAA;AAAA,MACA,CAAA,EAAG,MAAA,CAAO,UAAA,GAAa,QAAA,CAAS,gBAAgB,WAAW,CAAA,EAAA;AAAA,KAC7D;AAAA,IACA,QAAA,CAAS,QAAA,CAAS,eAAA,EAAiB,UAAA,EAAY,QAAQ;AAAA,GACzD;AACF;AA4BA,SAAS,yBAAA,GAA4B;AACnC,EAAA,IAAI,UAAA;AACJ,EAAA,IAAI,KAAA,GAAQ,CAAA;AAEZ,EAAA,MAAM,YAAA,GAAe,CAAC,CAAA,KAAkB;AA7J1C,IAAA,IAAA,EAAA;AA+JI,IAAA,MAAM,MAAA,GAAA,CAAS,EAAA,GAAA,CAAA,CAAE,YAAA,EAAa,KAAf,IAAA,GAAA,MAAA,GAAA,EAAA,CAAmB,CAAA,CAAA;AAGlC,IAAA,UAAA,GAAa,eAAA,CAAgB,QAAQ,IAAI,CAAA;AAEzC,IAAA,IACE,UAAA,KAAe,QAAA,CAAS,eAAA,IACxB,UAAA,KAAe,SAAS,IAAA,EACxB;AACA,MAAA;AAAA,IACF;AAEA,IAAA,KAAA,GAAQ,CAAA,CAAE,cAAA,CAAe,CAAC,CAAA,CAAE,KAAA;AAAA,EAC9B,CAAA;AAEA,EAAA,MAAM,WAAA,GAAc,CAAC,CAAA,KAAkB;AAIrC,IAAA,IAAI,eAAe,MAAA,EAAW;AAC5B,MAAA;AAAA,IACF;AAGA,IAAA,IACE,CAAC,UAAA,IACD,UAAA,KAAe,SAAS,eAAA,IACxB,UAAA,KAAe,SAAS,IAAA,EACxB;AACA,MAAA,CAAA,CAAE,cAAA,EAAe;AACjB,MAAA;AAAA,IACF;AAMA,IAAA,MAAM,CAAA,GAAI,CAAA,CAAE,cAAA,CAAe,CAAC,CAAA,CAAE,KAAA;AAC9B,IAAA,MAAM,YAAY,UAAA,CAAW,SAAA;AAC7B,IAAA,MAAM,MAAA,GAAS,UAAA,CAAW,YAAA,GAAe,UAAA,CAAW,YAAA;AAEpD,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA;AAAA,IACF;AAEA,IAAA,IAAK,aAAa,CAAA,IAAK,CAAA,GAAI,SAAW,SAAA,IAAa,MAAA,IAAU,IAAI,KAAA,EAAQ;AACvE,MAAA,CAAA,CAAE,cAAA,EAAe;AAAA,IACnB;AAEA,IAAA,KAAA,GAAQ,CAAA;AAAA,EACV,CAAA;AAEA,EAAA,MAAM,UAAA,GAAa,CAAC,CAAA,KAAkB;AAnNxC,IAAA,IAAA,EAAA;AAqNI,IAAA,MAAM,MAAA,GAAA,CAAS,EAAA,GAAA,CAAA,CAAE,YAAA,EAAa,KAAf,IAAA,GAAA,MAAA,GAAA,EAAA,CAAmB,CAAA,CAAA;AAGlC,IAAA,IAAI,gBAAA,CAAiB,MAAM,CAAA,IAAK,MAAA,KAAW,SAAS,aAAA,EAAe;AACjE,MAAA,CAAA,CAAE,cAAA,EAAe;AAKjB,MAAA,MAAA,CAAO,MAAM,SAAA,GAAY,qBAAA;AACzB,MAAA,MAAA,CAAO,KAAA,EAAM;AACb,MAAA,qBAAA,CAAsB,MAAM;AAC1B,QAAA,MAAA,CAAO,MAAM,SAAA,GAAY,EAAA;AAAA,MAC3B,CAAC,CAAA;AAAA,IACH;AAAA,EACF,CAAA;AAEA,EAAA,MAAM,OAAA,GAAU,CAAC,CAAA,KAAkB;AAtOrC,IAAA,IAAA,EAAA;AAwOI,IAAA,MAAM,MAAA,GAAA,CAAS,EAAA,GAAA,CAAA,CAAE,YAAA,EAAa,KAAf,IAAA,GAAA,MAAA,GAAA,EAAA,CAAmB,CAAA,CAAA;AAElC,IAAA,IAAI,gBAAA,CAAiB,MAAM,CAAA,EAAG;AAK5B,MAAA,MAAA,CAAO,MAAM,SAAA,GAAY,qBAAA;AACzB,MAAA,qBAAA,CAAsB,MAAM;AAC1B,QAAA,MAAA,CAAO,MAAM,SAAA,GAAY,EAAA;AAIzB,QAAA,IAAI,cAAA,EAAgB;AAClB,UAAA,IAAI,cAAA,CAAe,MAAA,GAAS,MAAA,CAAO,WAAA,EAAa;AAG9C,YAAA,qBAAA,CAAsB,MAAM;AAC1B,cAAA,cAAA,CAAe,MAAM,CAAA;AAAA,YACvB,CAAC,CAAA;AAAA,UACH,CAAA,MAAO;AAGL,YAAA,cAAA,CAAe,gBAAA;AAAA,cACb,QAAA;AAAA,cACA,MAAM,eAAe,MAAM,CAAA;AAAA,cAC3B,EAAE,MAAM,IAAA;AAAK,aACf;AAAA,UACF;AAAA,QACF;AAAA,MACF,CAAC,CAAA;AAAA,IACH;AAAA,EACF,CAAA;AAEA,EAAA,MAAM,iBAAiB,MAAM;AAG3B,IAAA,MAAA,CAAO,QAAA,CAAS,GAAG,CAAC,CAAA;AAAA,EACtB,CAAA;AAKA,EAAA,MAAM,UAAU,MAAA,CAAO,WAAA;AACvB,EAAA,MAAM,UAAU,MAAA,CAAO,WAAA;AAEvB,EAAA,MAAM,aAAA,GAAgB,KAAA;AAAA,IACpB,QAAA;AAAA,MACE,QAAA,CAAS,eAAA;AAAA,MACT,cAAA;AAAA,MACA,CAAA,EAAG,MAAA,CAAO,UAAA,GAAa,QAAA,CAAS,gBAAgB,WAAW,CAAA,EAAA;AAAA,KAC7D;AAAA,IACA,QAAA,CAAS,QAAA,CAAS,eAAA,EAAiB,UAAA,EAAY,QAAQ,CAAA;AAAA,IACvD,SAAS,QAAA,CAAS,IAAA,EAAM,WAAA,EAAa,CAAA,CAAA,EAAI,OAAO,CAAA,EAAA,CAAI;AAAA,GACtD;AAGA,EAAA,MAAA,CAAO,QAAA,CAAS,GAAG,CAAC,CAAA;AAEpB,EAAA,MAAM,YAAA,GAAe,KAAA;AAAA,IACnB,QAAA,CAAS,QAAA,EAAU,YAAA,EAAc,YAAA,EAAc;AAAA,MAC7C,OAAA,EAAS,KAAA;AAAA,MACT,OAAA,EAAS;AAAA,KACV,CAAA;AAAA,IACD,QAAA,CAAS,QAAA,EAAU,WAAA,EAAa,WAAA,EAAa;AAAA,MAC3C,OAAA,EAAS,KAAA;AAAA,MACT,OAAA,EAAS;AAAA,KACV,CAAA;AAAA,IACD,QAAA,CAAS,QAAA,EAAU,UAAA,EAAY,UAAA,EAAY;AAAA,MACzC,OAAA,EAAS,KAAA;AAAA,MACT,OAAA,EAAS;AAAA,KACV,CAAA;AAAA,IACD,QAAA,CAAS,QAAA,EAAU,OAAA,EAAS,OAAA,EAAS,IAAI,CAAA;AAAA,IACzC,QAAA,CAAS,MAAA,EAAQ,QAAA,EAAU,cAAc;AAAA,GAC3C;AAEA,EAAA,OAAO,MAAM;AAEX,IAAA,aAAA,EAAc;AACd,IAAA,YAAA,EAAa;AACb,IAAA,MAAA,CAAO,QAAA,CAAS,SAAS,OAAO,CAAA;AAAA,EAClC,CAAA;AACF;AAGA,SAAS,QAAA,CAAS,OAAA,EAAc,KAAA,EAAe,KAAA,EAAe;AAE5D,EAAA,MAAM,GAAA,GAAM,OAAA,CAAQ,KAAA,CAAM,KAAK,CAAA;AAC/B,EAAA,OAAA,CAAQ,KAAA,CAAM,KAAK,CAAA,GAAI,KAAA;AAEvB,EAAA,OAAO,MAAM;AACX,IAAA,OAAA,CAAQ,KAAA,CAAM,KAAK,CAAA,GAAI,GAAA;AAAA,EACzB,CAAA;AACF;AAGA,SAAS,QAAA,CACP,MAAA,EACA,KAAA,EACA,OAAA,EACA,OAAA,EACA;AAEA,EAAA,MAAA,CAAO,gBAAA,CAAiB,KAAA,EAAO,OAAA,EAAS,OAAO,CAAA;AAE/C,EAAA,OAAO,MAAM;AAEX,IAAA,MAAA,CAAO,mBAAA,CAAoB,KAAA,EAAO,OAAA,EAAS,OAAO,CAAA;AAAA,EACpD,CAAA;AACF;AAEA,SAAS,eAAe,MAAA,EAAiB;AACvC,EAAA,MAAM,IAAA,GAAO,QAAA,CAAS,gBAAA,IAAoB,QAAA,CAAS,eAAA;AACnD,EAAA,OAAO,MAAA,IAAU,WAAW,IAAA,EAAM;AAEhC,IAAA,MAAM,UAAA,GAAa,gBAAgB,MAAM,CAAA;AACzC,IAAA,IACE,eAAe,QAAA,CAAS,eAAA,IACxB,eAAe,QAAA,CAAS,IAAA,IACxB,eAAe,MAAA,EACf;AACA,MAAA,MAAM,aAAA,GAAgB,UAAA,CAAW,qBAAA,EAAsB,CAAE,GAAA;AACzD,MAAA,MAAM,SAAA,GAAY,MAAA,CAAO,qBAAA,EAAsB,CAAE,GAAA;AACjD,MAAA,MAAM,YAAA,GAAe,MAAA,CAAO,qBAAA,EAAsB,CAAE,MAAA;AAEpD,MAAA,MAAM,cAAA,GACJ,UAAA,CAAW,qBAAA,EAAsB,CAAE,MAAA,GAAS,eAAA;AAE9C,MAAA,IAAI,eAAe,cAAA,EAAgB;AACjC,QAAA,UAAA,CAAW,aAAa,SAAA,GAAY,aAAA;AAAA,MACtC;AAAA,IACF;AAGA,IAAA,MAAA,GAAS,UAAA,CAAW,aAAA;AAAA,EACtB;AACF;AAEA,SAAS,iBAAiB,MAAA,EAAiB;AACzC,EAAA,OACG,MAAA,YAAkB,gBAAA,IACjB,CAAC,iBAAA,CAAkB,GAAA,CAAI,MAAA,CAAO,IAAI,CAAA,IACpC,MAAA,YAAkB,mBAAA,IACjB,MAAA,YAAkB,WAAA,IAAe,MAAA,CAAO,iBAAA;AAE7C;ACrXO,SAAS,kBACd,OAAA,EACA;AACA,EAAA,MAAM,UAAA,GAAaL,cAAU,MAAS,CAAA;AAEtC,EAAA,yBAAA,CAA0B,MAAM;AAC9B,IAAA,UAAA,CAAW,OAAA,GAAU,OAAA;AAAA,EACvB,CAAC,CAAA;AAED,EAAA,OAAOC,kBAAAA,CAAY,IAAI,IAAA,KAAgB;AACrC,IAAA,MAAM,KAAK,UAAA,CAAW,OAAA;AACtB,IAAA,OAAO,yBAAK,GAAG,IAAA,CAAA;AAAA,EACjB,CAAA,EAAG,EAAE,CAAA;AACP;;;ACJO,SAAS,aAAA,CAAc;AAAA,EAC5B,MAAA;AAAA,EACA,QAAA,EAAU,SAAA;AAAA,EACV,SAAA,EAAW,UAAA;AAAA,EACX,MAAA,EAAQ,OAAA;AAAA,EACR,SAAA,EAAW;AACb,CAAA,EAAwB;AACtB,EAAA,MAAM,CAAC,KAAA,EAAO,QAAQ,IAAIC,eAAAA,CAAqB,MAAA,GAAS,YAAY,QAAQ,CAAA;AAC5E,EAAA,MAAM,QAAA,GAAW,iBAAA,CAAkB,MAAM,SAAA,IAAA,IAAA,GAAA,MAAA,GAAA,SAAA,EAAa,CAAA;AACtD,EAAA,MAAM,SAAA,GAAY,iBAAA,CAAkB,MAAM,UAAA,IAAA,IAAA,GAAA,MAAA,GAAA,UAAA,EAAc,CAAA;AACxD,EAAA,MAAM,MAAA,GAAS,iBAAA,CAAkB,MAAM,OAAA,IAAA,IAAA,GAAA,MAAA,GAAA,OAAA,EAAW,CAAA;AAClD,EAAA,MAAM,SAAA,GAAY,iBAAA,CAAkB,MAAM,UAAA,IAAA,IAAA,GAAA,MAAA,GAAA,UAAA,EAAc,CAAA;AAExD,EAAAC,iBAAU,MAAM;AACd,IAAA,IAAI,MAAA,IAAU,UAAU,QAAA,EAAU;AAChC,MAAA,QAAA,CAAS,SAAS,CAAA;AAAA,IACpB,WAAW,CAAC,MAAA,KAAW,KAAA,KAAU,MAAA,IAAU,UAAU,SAAA,CAAA,EAAY;AAC/D,MAAA,QAAA,CAAS,SAAS,CAAA;AAAA,IACpB;AAAA,EACF,CAAA,EAAG,CAAC,MAAA,EAAQ,KAAK,CAAC,CAAA;AAElB,EAAAA,iBAAU,MAAM;AACd,IAAA,eAAe,MAAA,GAAS;AACtB,MAAA,QAAQ,KAAA;AAAO,QACb,KAAK,QAAA;AACH,UAAA,OAAM,QAAA,IAAA,IAAA,GAAA,MAAA,GAAA,QAAA,EAAA,CAAA;AACN,UAAA;AAAA,QAEF,KAAK,SAAA;AACH,UAAA,OAAM,SAAA,IAAA,IAAA,GAAA,MAAA,GAAA,SAAA,EAAA,CAAA;AACN,UAAA,QAAA,CAAS,MAAM,CAAA;AACf,UAAA;AAAA,QAEF,KAAK,MAAA;AACH,UAAA,OAAM,MAAA,IAAA,IAAA,GAAA,MAAA,GAAA,MAAA,EAAA,CAAA;AACN,UAAA;AAAA,QAEF,KAAK,SAAA;AACH,UAAA,OAAM,SAAA,IAAA,IAAA,GAAA,MAAA,GAAA,SAAA,EAAA,CAAA;AACN,UAAA,QAAA,CAAS,QAAQ,CAAA;AACjB,UAAA;AAAA;AACJ,IACF;AACA,IAAA,MAAA,EAAO,CAAE,KAAA,CAAM,CAAC,KAAA,KAAU;AACxB,MAAA,OAAA,CAAQ,KAAA,CAAM,+BAA+B,KAAK,CAAA;AAAA,IACpD,CAAC,CAAA;AAAA,EACH,CAAA,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAA,OAAO,KAAA;AACT;ACCO,SAAS,kBAAA,CAAmB,OAAA,GAAqC,EAAC,EAAG;AAC1E,EAAA,MAAM;AAAA,IACJ,YAAA;AAAA,IACA,SAAA,GAAY,IAAA;AAAA,IACZ,aAAA,GAAgB,GAAA;AAAA,IAChB,sBAAA,GAAyB,IAAA;AAAA,IACzB,uBAAA,GAA0B;AAAA,GAC5B,GAAI,OAAA;AAEJ,EAAA,MAAM,CAAC,KAAA,EAAO,QAAQ,CAAA,GAAID,eAAAA,CAA+B;AAAA,IACvD,SAAA,EAAW,KAAA;AAAA,IACX,MAAA,EAAQ;AAAA,GACT,CAAA;AAED,EAAA,MAAM,iBAAA,GAAoBF,cAA2B,IAAI,CAAA;AACzD,EAAA,MAAM,aAAA,GAAgBA,cAA6C,IAAI,CAAA;AAEvE,EAAA,MAAM,WAAA,GAAc,iBAAA,CAAkB,CAAC,EAAA,KAAuB;AAC5D,IAAA,OAAA,CACE,EAAA,IAAA,IAAA,GAAA,MAAA,GAAA,EAAA,CAAI,aAAY,OAAA,IAAA,CAChB,EAAA,IAAA,IAAA,GAAA,MAAA,GAAA,EAAA,CAAI,aAAY,UAAA,IACf,sBAAA,IACC,EAAA,YAAc,WAAA,IACd,EAAA,CAAG,iBAAA;AAAA,EAET,CAAC,CAAA;AAED,EAAAG,iBAAU,MAAM;AACd,IAAA,IAAI,CAAC,SAAA,EAAW;AAEhB,IAAA,MAAM,KAAK,MAAA,CAAO,cAAA;AAClB,IAAA,MAAM,KAAM,SAAA,CAAkB,eAAA;AAE9B,IAAA,SAAS,0BAA0B,MAAA,EAAgB;AACjD,MAAA,MAAM,OAAA,GAAA,CAAU,YAAA,IAAA,IAAA,GAAA,MAAA,GAAA,YAAA,CAAc,OAAA,KAAW,QAAA,CAAS,eAAA;AAGlD,MAAA,IAAI,OAAO,eAAA,EAAiB;AAC1B,QAAA,OAAA,CAAQ,KAAA,CAAM,WAAA;AAAA,UACZ,yBAAA;AAAA,UACA,8BAA8B,MAAM,CAAA,GAAA;AAAA,SACtC;AAAA,MACF,CAAA,MAAO;AACL,QAAA,OAAA,CAAQ,KAAA,CAAM,WAAA,CAAY,yBAAA,EAA2B,CAAA,EAAG,MAAM,CAAA,EAAA,CAAI,CAAA;AAAA,MACpE;AAAA,IACF;AAEA,IAAA,SAAS,cAAc,CAAA,EAAe;AACpC,MAAA,IAAI,EAAE,MAAA,YAAkB,WAAA,IAAe,WAAA,CAAY,CAAA,CAAE,MAAM,CAAA,EAAG;AAC5D,QAAA,iBAAA,CAAkB,UAAU,CAAA,CAAE,MAAA;AAC9B,QAAA,mBAAA,EAAoB;AAAA,MACtB;AAAA,IACF;AAEA,IAAA,SAAS,cAAA,GAAiB;AACxB,MAAA,iBAAA,CAAkB,OAAA,GAAU,IAAA;AAC5B,MAAA,mBAAA,EAAoB;AAAA,IACtB;AAEA,IAAA,SAAS,mBAAA,GAAsB;AAC7B,MAAA,IAAI,cAAc,OAAA,EAAS;AACzB,QAAA,YAAA,CAAa,cAAc,OAAO,CAAA;AAAA,MACpC;AACA,MAAA,aAAA,CAAc,OAAA,GAAU,WAAW,MAAM;AACvC,QAAA,MAAM,SAAS,iBAAA,CAAkB,OAAA;AACjC,QAAA,MAAM,cAAA,GAAiB,YAAY,MAAM,CAAA;AAEzC,QAAA,IAAI,CAAC,cAAA,EAAgB;AACnB,UAAA,yBAAA,CAA0B,CAAC,CAAA;AAC3B,UAAA,QAAA,CAAS,EAAE,SAAA,EAAW,KAAA,EAAO,MAAA,EAAQ,GAAG,CAAA;AACxC,UAAA;AAAA,QACF;AAEA,QAAA,IAAI,EAAA,EAAI;AACN,UAAA,MAAM,UAAA,GAAa,MAAA,CAAO,WAAA,GAAc,EAAA,CAAG,MAAA;AAE3C,UAAA,IAAI,aAAa,uBAAA,EAAyB;AACxC,YAAA,yBAAA,CAA0B,UAAU,CAAA;AACpC,YAAA,QAAA,CAAS,EAAE,SAAA,EAAW,IAAA,EAAM,MAAA,EAAQ,YAAY,CAAA;AAAA,UAClD,CAAA,MAAO;AACL,YAAA,yBAAA,CAA0B,CAAC,CAAA;AAC3B,YAAA,QAAA,CAAS,EAAE,SAAA,EAAW,KAAA,EAAO,MAAA,EAAQ,GAAG,CAAA;AAAA,UAC1C;AAAA,QACF;AAAA,MACF,GAAG,aAAa,CAAA;AAAA,IAClB;AAEA,IAAA,MAAA,CAAO,gBAAA,CAAiB,WAAW,aAAa,CAAA;AAChD,IAAA,MAAA,CAAO,gBAAA,CAAiB,YAAY,cAAc,CAAA;AAElD,IAAA,IAAI,EAAA,EAAI;AACN,MAAA,EAAA,CAAG,gBAAA,CAAiB,UAAU,mBAAmB,CAAA;AACjD,MAAA,EAAA,CAAG,gBAAA,CAAiB,UAAU,mBAAmB,CAAA;AAAA,IACnD;AAEA,IAAA,IAAI,sBAAA,GAAyB,KAAA;AAE7B,IAAA,IAAI,EAAA,EAAI;AACN,MAAA,sBAAA,GAAyB,EAAA,CAAG,eAAA;AAC5B,MAAA,EAAA,CAAG,eAAA,GAAkB,IAAA;AAAA,IACvB;AAEA,IAAA,OAAO,MAAM;AACX,MAAA,MAAA,CAAO,mBAAA,CAAoB,WAAW,aAAa,CAAA;AACnD,MAAA,MAAA,CAAO,mBAAA,CAAoB,YAAY,cAAc,CAAA;AAErD,MAAA,IAAI,EAAA,EAAI;AACN,QAAA,EAAA,CAAG,mBAAA,CAAoB,UAAU,mBAAmB,CAAA;AACpD,QAAA,EAAA,CAAG,mBAAA,CAAoB,UAAU,mBAAmB,CAAA;AAAA,MACtD;AAEA,MAAA,IAAI,EAAA,EAAI;AACN,QAAA,EAAA,CAAG,eAAA,GAAkB,sBAAA;AAAA,MACvB;AAEA,MAAA,IAAI,cAAc,OAAA,EAAS;AACzB,QAAA,YAAA,CAAa,cAAc,OAAO,CAAA;AAAA,MACpC;AAAA,IACF,CAAA;AAAA,EACF,CAAA,EAAG;AAAA,IACD,aAAA;AAAA,IACA,sBAAA;AAAA,IACA,SAAA;AAAA,IACA;AAAA,GACD,CAAA;AAED,EAAA,OAAO;AAAA,IACL,gBAAgB,KAAA,CAAM,MAAA;AAAA,IACtB,gBAAgB,KAAA,CAAM;AAAA,GACxB;AACF;;;AC3JO,SAAS,iBAAA,CAAkB;AAAA,EAChC,cAAA;AAAA,EACA;AACF,CAAA,EAGqB;AACnB,EAAA,IAAI,cAAA,CAAe,CAAC,CAAA,KAAM,CAAA,EAAG;AAC3B,IAAA,OAAA,CAAQ,KAAA;AAAA,MACN,CAAA,4EAAA,EACW,cAAA,CAAe,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,KACtC;AACA,IAAA,cAAA,CAAe,QAAQ,CAAC,CAAA;AAAA,EAC1B;AAEA,EAAA,IAAI,cAAA,CAAe,cAAA,CAAe,MAAA,GAAS,CAAC,MAAM,CAAA,EAAG;AACnD,IAAA,OAAA,CAAQ,KAAA;AAAA,MACN,CAAA,2EAAA,EACW,cAAA,CAAe,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,KACtC;AACA,IAAA,cAAA,CAAe,KAAK,CAAC,CAAA;AAAA,EACvB;AAEA,EAAA,IAAI,eAAe,CAAA,EAAG;AACpB,IAAA,OAAA,CAAQ,KAAA;AAAA,MACN,mBAAmB,WAAW,CAAA,oFAAA;AAAA,KAEhC;AACA,IAAA,OAAO,EAAC;AAAA,EACV;AAEA,EAAA,MAAM,eAAA,GAAkB,cAAA,CAAe,GAAA,CAAI,CAAC,KAAA,KAAU;AAEpD,IAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,CAAA,EAAG;AAC3B,MAAA,OAAO,IAAA,CAAK,KAAA,CAAM,KAAA,GAAQ,WAAW,CAAA;AAAA,IACvC;AAEA,IAAA,OAAO,KAAA,GAAQ,CAAA,GAAI,WAAA,GAAc,KAAA,GAAQ,KAAA;AAAA,EAC3C,CAAC,CAAA;AAED,EAAA,OAAA,CAAQ,MAAA;AAAA,IACN,iBAAiB,eAAe,CAAA;AAAA,IAChC,CAAA,gDAAA,EAAmD,cAAA,CAAe,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,GAC9E;AAGA,EAAA,eAAA,CAAgB,OAAA,CAAQ,CAAC,IAAA,KAAS;AAChC,IAAA,IAAI,IAAA,GAAO,CAAA,IAAK,IAAA,GAAO,WAAA,EAAa;AAClC,MAAA,OAAA,CAAQ,IAAA;AAAA,QACN,CAAA,WAAA,EAAc,IAAI,CAAA,gCAAA,EAAmC,WAAW,CAAA,0EAAA;AAAA,OAElE;AAAA,IACF;AAAA,EACF,CAAC,CAAA;AAED,EAAA,IAAI,CAAC,eAAA,CAAgB,QAAA,CAAS,WAAW,CAAA,EAAG;AAC1C,IAAA,OAAA,CAAQ,IAAA;AAAA,MACN;AAAA,KAGF;AACA,IAAA,eAAA,CAAgB,KAAK,WAAW,CAAA;AAAA,EAClC;AAEA,EAAA,OAAO,eAAA,CAAgB,GAAA,CAAI,CAAC,IAAA,EAAM,KAAA,MAAW;AAAA,IAC3C,SAAA,EAAW,KAAA;AAAA,IACX,SAAA,EAAW,IAAA;AAAA;AAAA,IACX,YAAY,WAAA,GAAc;AAAA;AAAA,GAC5B,CAAE,CAAA;AACJ;AAEA,SAAS,oBAAA,CAAqB;AAAA,EAC5B,UAAA;AAAA,EACA;AACF,CAAA,EAGG;AACD,EAAA,OAAO,UAAA,CAAW,MAAA;AAAA,IAAO,CAAC,OAAA,EAAS,IAAA,KACjC,IAAA,CAAK,IAAI,IAAA,CAAK,UAAA,GAAa,QAAQ,CAAA,GACnC,KAAK,GAAA,CAAI,OAAA,CAAQ,UAAA,GAAa,QAAQ,IAClC,IAAA,GACA;AAAA,GACN;AACF;AAEA,SAAS,4BAAA,CAA6B;AAAA,EACpC,CAAA;AAAA,EACA,UAAA;AAAA,EACA;AACF,CAAA,EAIG;AAED,EAAA,IAAI,kBAAkB,MAAA,EAAQ;AAa5B,IAAA,OAAO,UAAA,CACJ,KAAA,EAAM,CACN,OAAA,EAAQ,CACR,KAAK,CAAC,CAAA,KAAM,CAAA,CAAE,UAAA,GAAa,CAAC,CAAA;AAAA,EACjC,CAAA,MAAO;AAYL,IAAA,OAAO,WAAW,IAAA,CAAK,CAAC,CAAA,KAAM,CAAA,CAAE,aAAa,CAAC,CAAA;AAAA,EAChD;AACF;AACO,SAAS,sBAAA,CAAuB;AAAA,EACrC,aAAA;AAAA,EACA;AACF,CAAA,EAGG;AAED,EAAA,MAAM,eAAA,GAAkB,WAAW,CAAC,CAAA;AACpC,EAAA,MAAM,YAAA,GAAe,UAAA,CAAW,UAAA,CAAW,MAAA,GAAS,CAAC,CAAA;AAErD,EAAA,IAAI,kBAAkB,MAAA,EAAQ;AAC5B,IAAA,OAAO;AAAA,MACL,KAAK,eAAA,CAAgB,UAAA;AAAA,MACrB,WAAW,eAAA,CAAgB;AAAA,KAC7B;AAAA,EACF;AACA,EAAA,OAAO;AAAA,IACL,KAAK,YAAA,CAAa,UAAA;AAAA,IAClB,WAAW,YAAA,CAAa;AAAA,GAC1B;AACF;AAEO,SAAS,qBAAA,CAAsB;AAAA,EACpC,gBAAA;AAAA,EACA,QAAA;AAAA,EACA,aAAA;AAAA,EACA,UAAA;AAAA,EACA;AACF,CAAA,EAMG;AACD,EAAA,MAAM,gCAAgC,oBAAA,CAAqB;AAAA,IACzD,UAAA;AAAA,IACA;AAAA,GACD,CAAA;AAOD,EAAA,IAAI,IAAA,CAAK,GAAA,CAAI,QAAQ,CAAA,GAAI,EAAA,EAAI;AAC3B,IAAA,OAAO;AAAA,MACL,KAAK,6BAAA,CAA8B,UAAA;AAAA,MACnC,WAAW,6BAAA,CAA8B;AAAA,KAC3C;AAAA,EACF;AAMA,EAAA,MAAM,wCAAwC,4BAAA,CAA6B;AAAA,IACzE,CAAA,EAAG,QAAA;AAAA,IACH,UAAA;AAAA,IACA;AAAA,GACD,CAAA;AAED,EAAA,IAAI,qCAAA,EAAuC;AACzC,IAAA,OAAO;AAAA,MACL,KAAK,qCAAA,CAAsC,UAAA;AAAA,MAC3C,WAAW,qCAAA,CAAsC;AAAA,KACnD;AAAA,EACF;AAGA,EAAA,OAAO;AAAA,IACL,KAAK,gBAAA,CAAiB,UAAA;AAAA,IACtB,WAAW,gBAAA,CAAiB;AAAA,GAC9B;AACF;;;ACxMO,IAAM,KAAA,GAAQN,iBAAAA;AAAA,EACnB,CACE;AAAA,IACE,aAAA,GAAgB,IAAA;AAAA,IAChB,QAAA;AAAA,IACA,SAAA,GAAY,EAAA;AAAA,IACZ,MAAA,GAAS,SAAA;AAAA,IACT,cAAA,GAAiB,KAAA;AAAA,IACjB,aAAa,eAAA,GAAkB,KAAA;AAAA,IAC/B,oBAAA,GAAuB,KAAA;AAAA,IACvB,kBAAA,GAAqB,4BAAA;AAAA,IACrB,qBAAA,GAAwB,+BAAA;AAAA,IACxB,WAAA;AAAA,IACA,MAAA;AAAA,IACA,iBAAA;AAAA,IACA,oBAAA;AAAA,IACA,UAAA;AAAA,IACA,oBAAA,GAAuB,KAAA;AAAA,IACvB,UAAA,EAAY,cAAA;AAAA,IACZ,KAAA;AAAA,IACA,WAAA,GAAc,oBAAA;AAAA,IACd,QAAA,GAAW,KAAA;AAAA,IACX,WAAA;AAAA,IACA,SAAA;AAAA,IACA,OAAA;AAAA,IACA,YAAA;AAAA,IACA,UAAA;AAAA,IACA,MAAA;AAAA,IACA,MAAA,EAAQ,UAAA;AAAA,IACR,WAAA,EAAa,eAAA;AAAA,IACb,SAAA,EAAW,aAAA;AAAA,IACX,GAAG;AAAA,KAEL,GAAA,KACG;AACH,IAAA,MAAM,CAAC,cAAA,EAAgB,WAAW,CAAA,GAAIY,2BAAA,EAAW;AACjD,IAAA,MAAM,QAAA,GAAWT,cAAuB,IAAI,CAAA;AAC5C,IAAA,MAAM,WAAA,GAAc,IAAA,CAAK,KAAA,CAAM,WAAA,CAAY,MAAM,CAAA;AACjD,IAAA,MAAM,CAAC,WAAA,EAAa,cAAc,CAAA,GAAIE,gBAAS,WAAW,CAAA;AAC1D,IAAA,MAAM,UAAA,GACJ,cAAA,IAAkB,WAAA,GAAc,CAAA,GAC5B,iBAAA,CAAkB,EAAE,WAAA,EAAa,cAAA,EAAgB,CAAA,GACjD,EAAC;AAEP,IAAA,MAAM,EAAE,YAAA,EAAa,GAAI,aAAA,EAAc;AACvC,IAAA,MAAM,OAAA,GAAU,WAAA,GAAc,CAAA,GAAI,WAAA,GAAc,YAAA;AAChD,IAAA,MAAM,CAAA,GAAIQ,qBAAe,OAAO,CAAA;AAChC,IAAA,MAAM,SAAA,GAAYJ,kBAAAA,CAAa,CAAA,EAAG,CAAC,GAAA,KAAQ,KAAK,GAAA,CAAI,WAAA,GAAc,GAAA,EAAK,CAAC,CAAC,CAAA;AACzE,IAAA,MAAM,iBAAA,GAAoBI,qBAAe,CAAC,CAAA;AAE1C,IAAA,MAAM,qBAAqBC,sBAAA,EAAiB;AAC5C,IAAA,MAAM,YAAA,GAAe,OAAA,CAAQ,oBAAA,IAAwB,kBAAkB,CAAA;AACvE,IAAA,MAAM,gBAAA,GAA+B;AAAA,MACnC,IAAA,EAAM,OAAA;AAAA,MACN,GAAI,eAAe,2BAAA,GAA8B;AAAA,KACnD;AAEA,IAAA,MAAM,WAAW,kBAAA,CAAmB;AAAA,MAClC,WAAW,MAAA,IAAU,aAAA;AAAA,MACrB,YAAA,EAAc;AAAA,KACf,CAAA;AAGD,IAAA,MAAM,WAAA,GAAc,SAAS,cAAA,IAAkB,eAAA;AAG/C,IAAA,MAAM,MAAA,GAASL,kBAAAA;AAAA,MAAa,CAAA;AAAA,MAAG,CAAC,GAAA,KAC9B,GAAA,GAAM,KAAK,OAAA,GAAU,EAAA,GAAA,CAAM,+BAAO,MAAA,KAAU;AAAA,KAC9C;AACA,IAAA,MAAM,UAAA,GAAaA,kBAAAA;AAAA,MAAa,CAAA;AAAA,MAAG,CAAC,GAAA,KAClC,GAAA,GAAM,CAAA,IAAK,UAAU,QAAA,GAAW;AAAA,KAClC;AAEA,IAAA,MAAM,UAAA,GAAa,iBAAA,CAAkB,CAAC,SAAA,KAAsB;AAC1D,MAAA,cAAA,CAAe,SAAS,CAAA;AACxB,MAAA,MAAA,IAAA,IAAA,GAAA,MAAA,GAAA,MAAA,CAAS,SAAA,CAAA;AAAA,IACX,CAAC,CAAA;AAED,IAAA,MAAM,YAAA,GAAe,iBAAA,CAAkB,CAAC,SAAA,KAAsB;AAC5D,MAAA,IAAI,kBAAkB,UAAA,EAAY;AAChC,QAAA,IAAI,SAAA,GAAY,CAAA,IAAK,SAAA,IAAa,UAAA,CAAW,MAAA,EAAQ;AACnD,UAAA,OAAA,CAAQ,IAAA;AAAA,YACN,sBAAsB,SAAS,CAAA,oBAAA,EAAuB,cAAA,CAAe,IAAA,CAAK,IAAI,CAAC,CAAA,kCAAA,EAAqC,UAAA,CACjH,GAAA,CAAI,CAAC,KAAA,KAAU,KAAA,CAAM,SAAS,CAAA,CAC9B,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,WACf;AACA,UAAA,OAAO,IAAA;AAAA,QACT;AACA,QAAA,OAAO,WAAW,SAAS,CAAA;AAAA,MAC7B;AACA,MAAA,OAAO,IAAA;AAAA,IACT,CAAC,CAAA;AAED,IAAA,MAAM,MAAA,GAAS,iBAAA,CAAkB,OAAO,SAAA,KAAsB;AAC5D,MAAA,IAAI,CAAC,cAAA,EAAgB;AACnB,QAAA,OAAA,CAAQ,KAAK,qDAAqD,CAAA;AAClE,QAAA;AAAA,MACF;AAEA,MAAA,MAAM,SAAA,GAAY,aAAa,SAAS,CAAA;AAExC,MAAA,IAAI,cAAc,IAAA,EAAM;AACtB,QAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,mBAAA,EAAsB,SAAS,CAAA,CAAA,CAAG,CAAA;AAC/C,QAAA;AAAA,MACF;AAEA,MAAA,IAAI,cAAc,CAAA,EAAG;AACnB,QAAA,OAAA,EAAQ;AACR,QAAA;AAAA,MACF;AAEA,MAAA,MAAMM,aAAA,CAAQ,CAAA,EAAG,SAAA,CAAU,UAAA,EAAY;AAAA,QACrC,GAAG,gBAAA;AAAA,QACH,UAAA,EAAY,MAAM,UAAA,CAAW,SAAS;AAAA,OACvC,CAAA;AAAA,IACH,CAAC,CAAA;AAED,IAAA,MAAM,eAAA,GAAkB,kBAAkB,MAAM;AAG9C,MAAA,MAAM,iBAAiB,QAAA,CAAS,aAAA;AAChC,MAAA,IAAI,CAAC,cAAA,IAAkB,CAAC,QAAA,CAAS,OAAA,EAAS;AAE1C,MAAA,MAAM,OAAA,GACJ,cAAA,CAAe,OAAA,KAAY,OAAA,IAC3B,eAAe,OAAA,KAAY,UAAA;AAG7B,MAAA,IAAI,OAAA,IAAW,QAAA,CAAS,OAAA,CAAQ,QAAA,CAAS,cAAc,CAAA,EAAG;AACxD,QAAA,cAAA,CAAe,IAAA,EAAK;AAAA,MACtB;AAAA,IACF,CAAC,CAAA;AAED,IAAA,MAAM,MAAA,GAAS,iBAAA,CAA+B,CAAC,KAAA,EAAO,IAAA,KAAS;AAC7D,MAAA,UAAA,IAAA,IAAA,GAAA,MAAA,GAAA,UAAA,CAAa,KAAA,EAAO,IAAA,CAAA;AAEpB,MAAA,MAAM,QAAA,GAAW,EAAE,GAAA,EAAI;AAGvB,MAAA,MAAM,QAAA,GAAW,EAAE,WAAA,EAAY;AAC/B,MAAA,IAAI,QAAA,GAAW,CAAA,EAAG,iBAAA,CAAkB,GAAA,CAAI,EAAE,CAAA;AAC1C,MAAA,IAAI,QAAA,GAAW,CAAA,EAAG,iBAAA,CAAkB,GAAA,CAAI,GAAG,CAAA;AAG3C,MAAA,CAAA,CAAE,GAAA,CAAI,KAAK,GAAA,CAAI,QAAA,GAAW,KAAK,KAAA,CAAM,CAAA,EAAG,CAAC,CAAC,CAAA;AAAA,IAC5C,CAAC,CAAA;AAED,IAAA,MAAM,WAAA,GAAc,iBAAA,CAA+B,CAAC,KAAA,EAAO,IAAA,KAAS;AAClE,MAAA,eAAA,EAAgB;AAChB,MAAA,eAAA,IAAA,IAAA,GAAA,MAAA,GAAA,eAAA,CAAkB,KAAA,EAAO,IAAA,CAAA;AAAA,IAC3B,CAAC,CAAA;AAED,IAAA,MAAM,SAAA,GAAY,iBAAA,CAA+B,CAAC,KAAA,EAAO,IAAA,KAAS;AAChE,MAAA,eAAA,EAAgB;AAChB,MAAA,aAAA,IAAA,IAAA,GAAA,MAAA,GAAA,aAAA,CAAgB,KAAA,EAAO,IAAA,CAAA;AAEvB,MAAA,MAAM,QAAA,GAAW,EAAE,GAAA,EAAI;AAEvB,MAAA,IAAI,GAAA,GAAM,CAAA;AAEV,MAAA,MAAM,gBAAA,GACJ,WAAA,KAAgB,MAAA,GAAY,YAAA,CAAa,WAAW,CAAA,GAAI,IAAA;AAE1D,MAAA,IAAI,gBAAA,EAAkB;AACpB,QAAA,MAAM,mBAAA,GAAsB,IAAA,CAAK,MAAA,CAAO,CAAA,GAAI,IAAI,MAAA,GAAS,IAAA;AACzD,QAAA,MAAM,qBAAA,GAAwB,IAAA,CAAK,QAAA,CAAS,CAAA,GAAI,IAAI,MAAA,GAAS,IAAA;AAC7D,QAAA,MAAM,iBACJ,IAAA,CAAK,GAAA,CAAI,IAAA,CAAK,QAAA,CAAS,CAAC,CAAA,GAAI,qBAAA;AAE9B,QAAA,IAAI,MAAA;AAEJ,QAAA,IAAI,cAAA,EAAgB;AAClB,UAAA,MAAA,GAAS,sBAAA,CAAuB;AAAA,YAC9B,UAAA;AAAA,YACA,aAAA,EAAe;AAAA,WAChB,CAAA;AAAA,QACH,CAAA,MAAO;AACL,UAAA,MAAA,GAAS,qBAAA,CAAsB;AAAA,YAC7B,gBAAA;AAAA,YACA,QAAA;AAAA,YACA,aAAA,EAAe,mBAAA;AAAA,YACf,UAAA;AAAA,YACA,QAAA,EAAU,KAAK,QAAA,CAAS;AAAA,WACzB,CAAA;AAAA,QACH;AAEA,QAAA,GAAA,GAAM,MAAA,CAAO,GAAA;AAGb,QAAA,IAAI,cAAA,IAAkB,GAAA,GAAM,CAAA,IAAK,WAAA,EAAa;AAE5C,UAAA,MAAM,kBAAkB,UAAA,CAAW,IAAA,CAAK,CAAC,CAAA,KAAM,CAAA,CAAE,YAAY,CAAC,CAAA;AAE9D,UAAA,IAAI,eAAA,EAAiB;AACnB,YAAA,GAAA,GAAM,eAAA,CAAgB,UAAA;AACtB,YAAA,UAAA,CAAW,gBAAgB,SAAS,CAAA;AAAA,UACtC,CAAA,MAAO;AAEL,YAAA,GAAA,GAAM,QAAA;AAAA,UACR;AAAA,QACF,CAAA,MAAA,IAAW,MAAA,CAAO,SAAA,KAAc,MAAA,EAAW;AACzC,UAAA,UAAA,CAAW,OAAO,SAAS,CAAA;AAAA,QAC7B;AAAA,MACF,WACE,IAAA,CAAK,QAAA,CAAS,IAAI,qBAAA,IAClB,QAAA,GAAW,cAAc,kBAAA,EACzB;AAGA,QAAA,IAAI,cAAA,EAAgB;AAElB,UAAA,GAAA,GAAM,CAAA;AAAA,QACR,CAAA,MAAO;AACL,UAAA,GAAA,GAAM,OAAA;AAAA,QACR;AAAA,MACF;AAGA,MAAAA,aAAA,CAAQ,CAAA,EAAG,KAAK,gBAAgB,CAAA;AAIhC,MAAA,IAAI,GAAA,GAAM,CAAA,IAAK,WAAA,IAAe,CAAC,cAAA,EAAgB;AAC7C,QAAA,OAAA,EAAQ;AAAA,MACV;AAGA,MAAA,iBAAA,CAAkB,IAAI,CAAC,CAAA;AAAA,IACzB,CAAC,CAAA;AAED,IAAAC,0BAAA,CAAoB,KAAK,OAAO;AAAA,MAC9B,CAAA;AAAA,MACA,SAAA;AAAA,MACA,MAAA,EAAQ,WAAA;AAAA,MACR;AAAA,KACF,CAAE,CAAA;AAEF,IAAA,cAAA,CAAe;AAAA,MACb,CAAA;AAAA,MACA,MAAA;AAAA,MACA,WAAA;AAAA,MACA,UAAA;AAAA,MACA,MAAA,EAAQ,iBAAA;AAAA,MACR,cAAA,EAAgB;AAAA,KACjB,CAAA;AAMD,IAAA,gBAAA,CAAiB;AAAA,MACf,UAAA,EAAY,wBAAwB,CAAC;AAAA,KACtC,CAAA;AAED,IAAA,MAAM,QAAQ,aAAA,CAAc;AAAA,MAC1B,MAAA;AAAA,MACA,QAAQ,YAAY;AAClB,QAAA,WAAA,IAAA,IAAA,GAAA,MAAA,GAAA,WAAA,EAAA;AAOA,QAAA,MAAM,eAAe,6BAA6B,CAAA;AAElD,QAAA,MAAM,gBAAA,GACJ,WAAA,KAAgB,MAAA,GAAY,YAAA,CAAa,WAAW,CAAA,GAAI,IAAA;AAE1D,QAAA,MAAM,GAAA,GAAA,CAAM,qDAAkB,UAAA,KAAc,CAAA;AAE5C,QAAA,MAAMD,aAAA,CAAQ,CAAA,EAAG,GAAA,EAAK,gBAAgB,CAAA;AAEtC,QAAA,IAAI,gBAAgB,MAAA,EAAW;AAC7B,UAAA,UAAA,CAAW,WAAW,CAAA;AAAA,QACxB;AAEA,QAAA,SAAA,IAAA,IAAA,GAAA,MAAA,GAAA,SAAA,EAAA;AAAA,MACF,CAAA;AAAA,MACA,WAAW,YAAY;AACrB,QAAA,YAAA,IAAA,IAAA,GAAA,MAAA,GAAA,YAAA,EAAA;AAEA,QAAA,MAAMA,aAAA,CAAQ,CAAA,EAAG,OAAA,EAAS,gBAAgB,CAAA;AAE1C,QAAA,UAAA,IAAA,IAAA,GAAA,MAAA,GAAA,UAAA,EAAA;AAAA,MACF;AAAA,KACD,CAAA;AAED,IAAA,MAAM,SAAA,GAA2C;AAAA,MAC/C,IAAA,EAAM,GAAA;AAAA,MACN,WAAA,EAAa,CAAA;AAAA,MACb,YAAA,EAAc,KAAA;AAAA,MACd,eAAA,EAAiB,KAAA;AAAA,MACjB,MAAA;AAAA,MACA,WAAA;AAAA,MACA;AAAA,KACF;AAEA,IAAA,MAAM,OAAA,GAA4B;AAAA,MAChC,WAAA;AAAA,MACA,MAAA;AAAA,MACA,WAAA;AAAA,MACA,SAAA;AAAA,MACA,iBAAA;AAAA,MACA,aAAA;AAAA,MACA,cAAA;AAAA,MACA,QAAA;AAAA,MACA,QAAA;AAAA,MACA;AAAA,KACF;AAEA,IAAA,MAAM,KAAA,mBACJb,uBAAAA,CAAA,aAAA,CAAC,YAAA,CAAa,UAAb,EAAsB,KAAA,EAAO,OAAA,EAAA,kBAC5BA,uBAAAA,CAAA,aAAA;AAAA,MAACD,YAAAA,CAAO,GAAA;AAAA,MAAP;AAAA,QACE,GAAG,IAAA;AAAA,QACJ,GAAA;AAAA,QACA,kBAAA,EAAkB,KAAA;AAAA,QAClB,SAAA,EAAW,0BAA0B,SAAS,CAAA,CAAA;AAAA,QAC9C,KAAA,EAAO;AAAA,UACL,GAAG,WAAA,CAAY,MAAA,CAAO,IAAA,EAAM,QAAQ,CAAA;AAAA,UACpC,MAAA;AAAA,UACA,UAAA;AAAA,UACA,GAAG;AAAA;AACL,OAAA;AAAA,MAEC,KAAA,KAAU,WAAW,QAAA,GAAW;AAAA,KAErC,CAAA;AAGF,IAAA,IAAI,QAAQ,OAAO,KAAA;AAEnB,IAAA,OAAOgB,qBAAA,CAAa,KAAA,EAAO,UAAA,IAAc,QAAA,CAAS,IAAI,CAAA;AAAA,EACxD;AACF,CAAA;AAEA,KAAA,CAAM,WAAA,GAAc,OAAA;;;ACxWb,IAAMC,MAAAA,GAAuB,MAAA,CAAO,MAAA,CAAO,KAAA,EAAW;AAAA,EAC3D,SAAA,EAAW,cAAA;AAAA,EACX,MAAA,EAAQ,WAAA;AAAA,EACR,aAAA,EAAe,kBAAA;AAAA,EACf,OAAA,EAAS,YAAA;AAAA,EACT,QAAA,EAAU;AACZ,CAAC","file":"index.js","sourcesContent":["import { createContext, useContext } from 'react';\nimport { type SheetContextType } from './types';\n\nexport const SheetContext = createContext<SheetContextType | undefined>(\n  undefined\n);\n\nexport function useSheetContext() {\n  const context = useContext(SheetContext);\n  if (!context) throw new Error('Sheet context error');\n  return context;\n}\n","import type { CSSProperties } from 'react';\n\nexport const styles = {\n  root: {\n    base: {\n      position: 'fixed',\n      top: 0,\n      bottom: 0,\n      left: 0,\n      right: 0,\n      overflow: 'hidden',\n      pointerEvents: 'none',\n    },\n    decorative: {},\n  },\n  backdrop: {\n    base: {\n      zIndex: 1,\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      touchAction: 'none',\n      userSelect: 'none',\n    },\n    decorative: {\n      backgroundColor: 'rgba(0, 0, 0, 0.2)',\n      border: 'none',\n      WebkitTapHighlightColor: 'transparent',\n    },\n  },\n  container: {\n    base: {\n      zIndex: 2,\n      position: 'absolute',\n      left: 0,\n      bottom: 0,\n      width: '100%',\n      pointerEvents: 'auto',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    decorative: {\n      backgroundColor: '#fff',\n      borderTopRightRadius: '8px',\n      borderTopLeftRadius: '8px',\n      boxShadow: '0px -2px 16px rgba(0, 0, 0, 0.3)',\n    },\n  },\n  headerWrapper: {\n    base: {\n      width: '100%',\n    },\n    decorative: {},\n  },\n  header: {\n    base: {\n      width: '100%',\n      position: 'relative',\n    },\n    decorative: {\n      height: '40px',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n  },\n  indicatorWrapper: {\n    base: {\n      display: 'flex',\n    },\n    decorative: {},\n  },\n  indicator: {\n    base: {\n      display: 'inline-block',\n    },\n    decorative: {\n      width: '18px',\n      height: '4px',\n      borderRadius: '99px',\n      backgroundColor: '#ddd',\n    },\n  },\n  content: {\n    base: {\n      minHeight: '0px',\n      position: 'relative',\n      flexGrow: 1,\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    decorative: {},\n  },\n  scroller: {\n    base: {\n      height: '100%',\n      overflowY: 'auto',\n      overscrollBehaviorY: 'none',\n    },\n    decorative: {},\n  },\n} satisfies Record<\n  string,\n  {\n    base: CSSProperties;\n    decorative: CSSProperties;\n  }\n>;\n","import type { SheetTweenConfig } from './types';\n\nexport const DEFAULT_HEIGHT = 'calc(100% - env(safe-area-inset-top) - 34px)';\n\nexport const IS_SSR = typeof window === 'undefined';\n\nexport const DEFAULT_TWEEN_CONFIG: SheetTweenConfig = {\n  ease: 'easeOut',\n  duration: 0.2,\n};\n\nexport const REDUCED_MOTION_TWEEN_CONFIG: SheetTweenConfig = {\n  ease: 'linear',\n  duration: 0.01,\n};\n\nexport const DEFAULT_DRAG_CLOSE_THRESHOLD = 0.6;\n\nexport const DEFAULT_DRAG_VELOCITY_THRESHOLD = 500;\n","import { type CSSProperties, type ForwardedRef, type RefCallback } from 'react';\nimport { IS_SSR } from './constants';\n\nexport function applyStyles(\n  styles: { base: CSSProperties; decorative: CSSProperties },\n  unstyled: boolean\n) {\n  return unstyled ? styles.base : { ...styles.base, ...styles.decorative };\n}\n\nexport function isAscendingOrder(arr: number[]) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i + 1] < arr[i]) return false;\n  }\n  return true;\n}\n\nexport function mergeRefs<T = any>(refs: ForwardedRef<T>[]): RefCallback<T> {\n  return (value: any) => {\n    refs.forEach((ref: any) => {\n      if (typeof ref === 'function') {\n        ref(value);\n      } else if (ref) {\n        ref.current = value;\n      }\n    });\n  };\n}\n\nexport function isTouchDevice() {\n  if (IS_SSR) return false;\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n}\n\nfunction testPlatform(re: RegExp) {\n  return typeof window !== 'undefined' && window.navigator != null\n    ? re.test(\n        // @ts-expect-error\n        window.navigator.userAgentData?.platform || window.navigator.platform\n      )\n    : false;\n}\n\nfunction cached(fn: () => boolean) {\n  let res: boolean | null = null;\n  return () => {\n    if (res == null) {\n      res = fn();\n    }\n    return res;\n  };\n}\n\nconst isMac = cached(function () {\n  return testPlatform(/^Mac/i);\n});\n\nconst isIPhone = cached(function () {\n  return testPlatform(/^iPhone/i);\n});\n\nconst isIPad = cached(function () {\n  // iPadOS 13 lies and says it's a Mac, but we can distinguish by detecting touch support.\n  return testPlatform(/^iPad/i) || (isMac() && navigator.maxTouchPoints > 1);\n});\n\nexport const isIOS = cached(function () {\n  return isIPhone() || isIPad();\n});\n\n/** Wait for an element to be rendered and visible */\nexport function waitForElement(\n  className: string,\n  interval = 50,\n  maxAttempts = 20\n) {\n  return new Promise<HTMLElement | null>((resolve) => {\n    let attempts = 0;\n    const timer = setInterval(() => {\n      const element = document.getElementsByClassName(\n        className\n      )[0] as HTMLElement;\n      attempts++;\n      if (element || attempts >= maxAttempts) {\n        clearInterval(timer);\n        resolve(element);\n      }\n    }, interval);\n  });\n}\n","import { type MotionStyle, motion } from 'motion/react';\nimport React, { forwardRef } from 'react';\n\nimport { useSheetContext } from './context';\nimport { styles } from './styles';\nimport { type SheetBackdropProps } from './types';\nimport { applyStyles } from './utils';\n\nconst isClickable = (props: any) => !!props.onClick || !!props.onTap;\n\nexport const SheetBackdrop = forwardRef<any, SheetBackdropProps>(\n  ({ style, className = '', unstyled, ...rest }, ref) => {\n    const sheetContext = useSheetContext();\n    const clickable = isClickable(rest);\n    const Comp = clickable ? motion.button : motion.div;\n    const pointerEvents = clickable ? 'auto' : 'none';\n\n    const isUnstyled = unstyled ?? sheetContext.unstyled;\n\n    const backdropStyle: MotionStyle = {\n      ...applyStyles(styles.backdrop, isUnstyled),\n      ...style,\n      pointerEvents,\n    };\n\n    return (\n      <Comp\n        {...(rest as any)}\n        ref={ref}\n        className={`react-modal-sheet-backdrop ${className}`}\n        style={backdropStyle}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        transition={{ duration: 1 }}\n      />\n    );\n  }\n);\n\nSheetBackdrop.displayName = 'SheetBackdrop';\n","import { type MotionStyle, motion } from 'motion/react';\nimport React, { forwardRef } from 'react';\n\nimport { DEFAULT_HEIGHT } from './constants';\nimport { useSheetContext } from './context';\nimport { styles } from './styles';\nimport { type SheetContainerProps } from './types';\nimport { applyStyles, mergeRefs } from './utils';\n\nexport const SheetContainer = forwardRef<any, SheetContainerProps>(\n  ({ children, style, className = '', unstyled, ...rest }, ref) => {\n    const sheetContext = useSheetContext();\n\n    const isUnstyled = unstyled ?? sheetContext.unstyled;\n\n    const containerStyle: MotionStyle = {\n      ...applyStyles(styles.container, isUnstyled),\n      ...style,\n      y: sheetContext.y,\n    };\n\n    if (sheetContext.detent === 'default') {\n      containerStyle.height = DEFAULT_HEIGHT;\n    }\n\n    if (sheetContext.detent === 'full') {\n      containerStyle.height = '100%';\n      containerStyle.maxHeight = '100%';\n    }\n\n    if (sheetContext.detent === 'content') {\n      containerStyle.height = 'auto';\n      containerStyle.maxHeight = DEFAULT_HEIGHT;\n    }\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([\n          ref,\n          sheetContext.sheetRef,\n          sheetContext.sheetBoundsRef,\n        ])}\n        className={`react-modal-sheet-container ${className}`}\n        style={containerStyle}\n      >\n        {children}\n      </motion.div>\n    );\n  }\n);\n\nSheetContainer.displayName = 'SheetContainer';\n","import { useCallback, useRef } from 'react';\n\nimport { type BoundingBox } from 'motion/react';\n\n// This is a hacky way to fix a bug in motion/react where the drag\n// constraints are not updated when window is resized.\n// https://github.com/framer/motion/issues/1659\nconst constraints: BoundingBox = { bottom: 0, top: 0, left: 0, right: 0 };\n\nexport function useDragConstraints() {\n  const ref = useRef<any>(null);\n  const onMeasure = useCallback(() => constraints, []);\n  return { ref, onMeasure };\n}\n","import { useEffect, useState } from 'react';\n\ntype UseScrollPositionOptions = {\n  /**\n   * Debounce delay in ms for scroll event handling.\n   * @default 32\n   */\n  debounceDelay?: number;\n  /**\n   * Enable or disable the hook entirely.\n   * @default true\n   */\n  isEnabled?: boolean;\n};\n\n/**\n * Hook to track the scroll position of an element.\n *\n * The scroll position can be 'top', 'bottom', 'middle', or undefined if the content is not scrollable.\n * The hook provides a `scrollRef` callback to assign to the scrollable element.\n *\n * Note that the scroll position is only updated when the user stops scrolling\n * for a short moment (debounced). You can set `debounceDelay` to `0` to disable debouncing entirely.\n *\n * @param options Configuration options for the hook.\n * @returns An object containing the `scrollRef` callback and the current `scrollPosition`.\n *\n * @example\n * ```tsx\n * import { useScrollPosition } from 'react-modal-sheet';\n *\n * function MyComponent() {\n *   const { scrollRef, scrollPosition } = useScrollPosition();\n *\n *   return (\n *     <div>\n *       <p>Scroll position: {scrollPosition}</p>\n *       <div ref={scrollRef} style={{ overflowY: 'auto', maxHeight: '300px' }}>\n *         ...long content...\n *       </div>\n *     </div>\n *   );\n * }\n * ```\n */\nexport function useScrollPosition(options: UseScrollPositionOptions = {}) {\n  const { debounceDelay = 32, isEnabled = true } = options;\n\n  const [element, setElement] = useState<HTMLElement | null>(null);\n  const [scrollPosition, setScrollPosition] = useState<\n    'top' | 'bottom' | 'middle' | undefined\n  >(undefined);\n\n  useEffect(() => {\n    if (!element || !isEnabled) return;\n\n    let scrollTimeout: number | null = null;\n\n    function determineScrollPosition(element: HTMLElement) {\n      const { scrollTop, scrollHeight, clientHeight } = element;\n      const isScrollable = scrollHeight > clientHeight;\n\n      if (!isScrollable) {\n        // Reset scroll position if the content is not scrollable anymore\n        if (scrollPosition) setScrollPosition(undefined);\n        return;\n      }\n\n      const isAtTop = scrollTop <= 0;\n      const isAtBottom =\n        Math.ceil(scrollHeight) - Math.ceil(scrollTop) ===\n        Math.ceil(clientHeight);\n\n      let position: 'top' | 'bottom' | 'middle';\n\n      if (isAtTop) {\n        position = 'top';\n      } else if (isAtBottom) {\n        position = 'bottom';\n      } else {\n        position = 'middle';\n      }\n\n      if (position === scrollPosition) return;\n      setScrollPosition(position);\n    }\n\n    function onScroll(event: Event) {\n      if (event.currentTarget instanceof HTMLElement) {\n        const el = event.currentTarget;\n\n        if (scrollTimeout) clearTimeout(scrollTimeout);\n\n        if (debounceDelay === 0) {\n          determineScrollPosition(el);\n        } else {\n          // Debounce the scroll handler\n          scrollTimeout = setTimeout(\n            () => determineScrollPosition(el),\n            debounceDelay\n          );\n        }\n      }\n    }\n\n    function onTouchStart(event: Event) {\n      if (event.currentTarget instanceof HTMLElement) {\n        determineScrollPosition(event.currentTarget);\n      }\n    }\n\n    // Determine initial scroll position\n    determineScrollPosition(element);\n\n    element.addEventListener('scroll', onScroll);\n    element.addEventListener('touchstart', onTouchStart);\n\n    return () => {\n      if (scrollTimeout) clearTimeout(scrollTimeout);\n      element.removeEventListener('scroll', onScroll);\n      element.removeEventListener('touchstart', onTouchStart);\n    };\n  }, [element, isEnabled]);\n\n  return {\n    scrollRef: (element: HTMLElement | null) => setElement(element),\n    scrollPosition,\n  };\n}\n","import { type MotionStyle, motion } from 'motion/react';\nimport React, { forwardRef } from 'react';\n\nimport { useSheetContext } from './context';\nimport { useDragConstraints } from './hooks/use-drag-constraints';\nimport { useScrollPosition } from './hooks/use-scroll-position';\nimport { styles } from './styles';\nimport { type SheetContentProps } from './types';\nimport { applyStyles, mergeRefs } from './utils';\n\nexport const SheetContent = forwardRef<any, SheetContentProps>(\n  (\n    {\n      disableScroll: disableScrollProp,\n      disableDrag: disableDragProp,\n      children,\n      style: styleProp,\n      className = '',\n      scrollClassName = '',\n      scrollStyle: scrollStyleProp,\n      scrollRef: scrollRefProp = null,\n      unstyled,\n      ...rest\n    },\n    ref\n  ) => {\n    const sheetContext = useSheetContext();\n    const dragConstraints = useDragConstraints();\n    const scroll = useScrollPosition();\n\n    const disableScroll =\n      typeof disableScrollProp === 'function'\n        ? disableScrollProp({\n            scrollPosition: scroll.scrollPosition,\n            currentSnap: sheetContext.currentSnap,\n          })\n        : Boolean(disableScrollProp);\n\n    const disableDragDueToScroll =\n      !disableScroll &&\n      scroll.scrollPosition &&\n      scroll.scrollPosition !== 'top';\n\n    const disableDragDueToProp =\n      typeof disableDragProp === 'function'\n        ? disableDragProp({\n            scrollPosition: scroll.scrollPosition,\n            currentSnap: sheetContext.currentSnap,\n          })\n        : Boolean(disableDragProp);\n\n    const disableDrag =\n      disableDragDueToProp ||\n      disableDragDueToScroll ||\n      sheetContext.disableDrag;\n\n    const dragProps =\n      disableDrag || sheetContext.disableDrag\n        ? undefined\n        : sheetContext.dragProps;\n\n    const isUnstyled = unstyled ?? sheetContext.unstyled;\n\n    const contentStyle: MotionStyle = {\n      ...applyStyles(styles.content, isUnstyled),\n      ...styleProp,\n    };\n\n    const scrollStyle: MotionStyle = applyStyles(styles.scroller, isUnstyled);\n\n    if (sheetContext.avoidKeyboard) {\n      scrollStyle.paddingBottom =\n        'env(keyboard-inset-height, var(--keyboard-inset-height, 0px))';\n    }\n\n    if (disableScroll) {\n      scrollStyle.overflowY = 'hidden';\n    }\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([ref, dragConstraints.ref])}\n        className={`react-modal-sheet-content ${className}`}\n        style={contentStyle}\n        {...dragProps}\n        dragConstraints={dragConstraints.ref}\n        onMeasureDragConstraints={dragConstraints.onMeasure}\n      >\n        <motion.div\n          ref={mergeRefs([scroll.scrollRef, scrollRefProp])}\n          style={{ ...scrollStyle, ...scrollStyleProp }}\n          className={`react-modal-sheet-content-scroller ${scrollClassName}`}\n        >\n          {children}\n        </motion.div>\n      </motion.div>\n    );\n  }\n);\n\nSheetContent.displayName = 'SheetContent';\n","import { motion, useTransform } from 'motion/react';\nimport React from 'react';\n\nimport { useSheetContext } from './context';\nimport { styles } from './styles';\nimport type { SheetDragIndicatorProps } from './types';\nimport { applyStyles } from './utils';\n\nexport function SheetDragIndicator({\n  style,\n  className = '',\n  unstyled,\n  ...rest\n}: SheetDragIndicatorProps) {\n  const sheetContext = useSheetContext();\n\n  const indicator1Transform = useTransform(\n    sheetContext.indicatorRotation,\n    (r) => `translateX(2px) rotate(${r}deg)`\n  );\n\n  const indicator2Transform = useTransform(\n    sheetContext.indicatorRotation,\n    (r) => `translateX(-2px) rotate(${-1 * r}deg)`\n  );\n\n  const isUnstyled = unstyled ?? sheetContext.unstyled;\n\n  const indicatorWrapperStyle = {\n    ...applyStyles(styles.indicatorWrapper, isUnstyled),\n    ...style,\n  };\n\n  const indicatorStyle = applyStyles(styles.indicator, isUnstyled);\n\n  return (\n    <div\n      className={`react-modal-sheet-drag-indicator-container ${className}`}\n      style={indicatorWrapperStyle}\n      {...rest}\n    >\n      <motion.span\n        className=\"react-modal-sheet-drag-indicator\"\n        style={{ ...indicatorStyle, transform: indicator1Transform }}\n      />\n      <motion.span\n        className=\"react-modal-sheet-drag-indicator\"\n        style={{ ...indicatorStyle, transform: indicator2Transform }}\n      />\n    </div>\n  );\n}\n","import { motion } from 'motion/react';\nimport React, { forwardRef } from 'react';\n\nimport { SheetDragIndicator } from './SheetDragIndicator';\nimport { useSheetContext } from './context';\nimport { useDragConstraints } from './hooks/use-drag-constraints';\nimport { styles } from './styles';\nimport { type SheetHeaderProps } from './types';\nimport { applyStyles, mergeRefs } from './utils';\n\nexport const SheetHeader = forwardRef<any, SheetHeaderProps>(\n  (\n    { children, style, disableDrag, unstyled, className = '', ...rest },\n    ref\n  ) => {\n    const sheetContext = useSheetContext();\n    const dragConstraints = useDragConstraints();\n    const dragProps =\n      disableDrag || sheetContext.disableDrag\n        ? undefined\n        : sheetContext.dragProps;\n\n    const isUnstyled = unstyled ?? sheetContext.unstyled;\n\n    const headerWrapperStyle = {\n      ...applyStyles(styles.headerWrapper, isUnstyled),\n      ...style,\n    };\n\n    const headerStyle = applyStyles(styles.header, isUnstyled);\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([ref, dragConstraints.ref])}\n        style={headerWrapperStyle}\n        className={`react-modal-sheet-header-container ${className}`}\n        {...dragProps}\n        dragConstraints={dragConstraints.ref}\n        onMeasureDragConstraints={dragConstraints.onMeasure}\n      >\n        {children || (\n          <div className=\"react-modal-sheet-header\" style={headerStyle}>\n            <SheetDragIndicator />\n          </div>\n        )}\n      </motion.div>\n    );\n  }\n);\n\nSheetHeader.displayName = 'SheetHeader';\n","import { useEffect, useLayoutEffect } from 'react';\n\nimport { IS_SSR } from '../constants';\n\nexport const useIsomorphicLayoutEffect = IS_SSR ? useEffect : useLayoutEffect;\n","import { useState } from 'react';\n\nimport { IS_SSR } from '../constants';\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect';\n\nexport function useDimensions() {\n  const [dimensions, setDimensions] = useState(() => ({\n    windowHeight: !IS_SSR ? window.innerHeight : 0,\n    windowWidth: !IS_SSR ? window.innerWidth : 0,\n  }));\n\n  useIsomorphicLayoutEffect(() => {\n    function handler() {\n      setDimensions({\n        windowHeight: window.innerHeight,\n        windowWidth: window.innerWidth,\n      });\n    }\n\n    handler();\n\n    window.addEventListener('resize', handler);\n\n    return () => {\n      window.removeEventListener('resize', handler);\n    };\n  }, []);\n\n  return dimensions;\n}\n","import { useState } from 'react';\n\nimport { IS_SSR } from '../constants';\n\nexport function useSafeAreaInsets() {\n  const [insets] = useState(() => {\n    const fallback = { top: 0, left: 0, right: 0, bottom: 0 };\n\n    if (IS_SSR) return fallback;\n\n    const root = document.querySelector<HTMLElement>(':root');\n\n    if (!root) return fallback;\n\n    root.style.setProperty('--rms-sat', 'env(safe-area-inset-top)');\n    root.style.setProperty('--rms-sal', 'env(safe-area-inset-left)');\n    root.style.setProperty('--rms-sar', 'env(safe-area-inset-right)');\n    root.style.setProperty('--rms-sab', 'env(safe-area-inset-bottom)');\n\n    const computedStyle = getComputedStyle(root);\n    const sat = getComputedValue(computedStyle, '--rms-sat');\n    const sal = getComputedValue(computedStyle, '--rms-sal');\n    const sar = getComputedValue(computedStyle, '--rms-sar');\n    const sab = getComputedValue(computedStyle, '--rms-sab');\n\n    root.style.removeProperty('--rms-sat');\n    root.style.removeProperty('--rms-sal');\n    root.style.removeProperty('--rms-sar');\n    root.style.removeProperty('--rms-sab');\n\n    return { top: sat, left: sal, right: sar, bottom: sab };\n  });\n\n  return insets;\n}\n\nfunction getComputedValue(computed: CSSStyleDeclaration, property: string) {\n  const strValue = computed.getPropertyValue(property).replace('px', '').trim();\n  return parseInt(strValue, 10) || 0;\n}\n","import { type MotionValue, transform } from 'motion';\nimport { type RefObject } from 'react';\n\nimport type { SheetDetent, SheetSnapPoint } from '../types';\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect';\nimport { useSafeAreaInsets } from './use-safe-area-insets';\n\nexport function useModalEffect({\n  y,\n  detent,\n  rootId: _rootId,\n  sheetHeight,\n  snapPoints,\n  startThreshold,\n}: {\n  y: MotionValue<number>;\n  detent: SheetDetent;\n  rootId?: string;\n  sheetHeight: number;\n  snapPoints: SheetSnapPoint[];\n  startThreshold?: number;\n}) {\n  const insetTop = useSafeAreaInsets().top;\n\n  let rootId: string | undefined = _rootId;\n\n  if (rootId && detent === 'full') {\n    console.warn('Using \"full\" detent with modal effect is not supported.');\n    rootId = undefined;\n  }\n\n  // Cleanup on unmount\n  useIsomorphicLayoutEffect(() => {\n    return () => {\n      if (rootId) cleanupModalEffect(rootId);\n    };\n  }, []);\n\n  useIsomorphicLayoutEffect(() => {\n    if (!rootId) return;\n\n    const root = document.querySelector(`#${rootId}`) as HTMLDivElement;\n    if (!root) return;\n\n    const removeStartListener = y.on('animationStart', () => {\n      // biome-ignore lint/style/noNonNullAssertion: root is always defined here\n      setupModalEffect(rootId!);\n    });\n\n    /**\n     * NOTE: The `y` value gets smaller when the sheet is opened and larger\n     * when the sheet is being closed.\n     */\n    const removeChangeListener = y.on('change', (yValue) => {\n      if (!root) return;\n\n      let progress = Math.max(0, 1 - yValue / sheetHeight);\n\n      /**\n       * Start the effect only if we have dragged over the second snap point\n       * to make the effect more natural as the sheet will reach it's final\n       * position when the user drags it over the second snap point.\n       */\n      const snapThresholdPoint =\n        snapPoints.length > 1 ? snapPoints[snapPoints.length - 2] : undefined;\n\n      /**\n       * If we have snap points, we need to calculate the progress percentage\n       * based on the snap point threshold. Note that the maximum value is also\n       * different in this case as the range between the start of the effect\n       * and its end is different.\n       */\n      if (snapThresholdPoint !== undefined) {\n        const snapThresholdValue = snapThresholdPoint.snapValueY;\n\n        if (yValue <= snapThresholdValue) {\n          progress = (snapThresholdValue - yValue) / snapThresholdValue;\n        } else {\n          progress = 0;\n        }\n      }\n\n      /**\n       * If we have a start threshold, we need to calculate the progress\n       * percentage based on the start threshold (0 to 1). For example,\n       * if the start threshold is 0.5, the progress will be 0 until the sheet\n       * is dragged over 50% of the complete drag distance.\n       */\n      if (startThreshold !== undefined) {\n        const startThresholdValue =\n          sheetHeight -\n          Math.min(Math.floor(startThreshold * sheetHeight), sheetHeight);\n\n        if (yValue <= startThresholdValue) {\n          progress = (startThresholdValue - yValue) / startThresholdValue;\n        } else {\n          progress = 0;\n        }\n      }\n\n      // Make sure progress is between 0 and 1\n      progress = Math.max(0, Math.min(1, progress));\n\n      const pageWidth = window.innerWidth;\n      const ty = transform(progress, [0, 1], [0, 24 + insetTop]);\n      const s = transform(progress, [0, 1], [1, (pageWidth - 16) / pageWidth]);\n      const borderRadius = transform(progress, [0, 1], [0, 10]);\n\n      root.style.transform = `scale(${s}) translate3d(0, ${ty}px, 0)`;\n      root.style.borderTopRightRadius = `${borderRadius}px`;\n      root.style.borderTopLeftRadius = `${borderRadius}px`;\n    });\n\n    function onCompleted() {\n      // -5 just to take into account some inprecision to ensure the cleanup is done\n      if (y.get() - 5 >= sheetHeight) {\n        // biome-ignore lint/style/noNonNullAssertion: root is always defined here\n        cleanupModalEffect(rootId!);\n      }\n    }\n\n    const removeCompleteListener = y.on('animationComplete', onCompleted);\n    const removeCancelListener = y.on('animationCancel', onCompleted);\n\n    return () => {\n      removeStartListener();\n      removeChangeListener();\n      removeCompleteListener();\n      removeCancelListener();\n    };\n  }, [y, rootId, insetTop, startThreshold, sheetHeight]);\n}\n\nfunction setupModalEffect(rootId: string) {\n  const root = document.querySelector(`#${rootId}`) as HTMLDivElement;\n  const body = document.querySelector('body') as HTMLBodyElement;\n  if (!root) return;\n\n  body.style.backgroundColor = '#000';\n  root.style.overflow = 'hidden';\n  root.style.transitionTimingFunction = 'cubic-bezier(0.32, 0.72, 0, 1)';\n  root.style.transitionProperty = 'transform, border-radius';\n  root.style.transitionDuration = '0.5s';\n  root.style.transformOrigin = 'center top';\n}\n\nfunction cleanupModalEffect(rootId: string) {\n  const root = document.querySelector(`#${rootId}`) as HTMLDivElement;\n  const body = document.querySelector('body') as HTMLBodyElement;\n  if (!root) return;\n\n  body.style.removeProperty('background-color');\n  root.style.removeProperty('overflow');\n  root.style.removeProperty('transition-timing-function');\n  root.style.removeProperty('transition-property');\n  root.style.removeProperty('transition-duration');\n  root.style.removeProperty('transform-origin');\n  root.style.removeProperty('transform');\n  root.style.removeProperty('border-top-right-radius');\n  root.style.removeProperty('border-top-left-radius');\n}\n","// This code originates from https://github.com/adobe/react-spectrum/blob/main/packages/%40react-aria/overlays/src/usePreventScroll.ts\n\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect';\nimport { isIOS } from '../utils';\n\nconst KEYBOARD_BUFFER = 24;\n\ninterface PreventScrollOptions {\n  /** Whether the scroll lock is disabled. */\n  isDisabled?: boolean;\n}\n\nfunction chain(...callbacks: any[]): (...args: any[]) => void {\n  return (...args: any[]) => {\n    for (const callback of callbacks) {\n      if (typeof callback === 'function') {\n        callback(...args);\n      }\n    }\n  };\n}\n\nconst visualViewport = typeof document !== 'undefined' && window.visualViewport;\n\nexport function isScrollable(\n  node: Element | null,\n  checkForOverflow?: boolean\n): boolean {\n  if (!node) {\n    return false;\n  }\n\n  const style = window.getComputedStyle(node);\n\n  let isScrollable = /(auto|scroll)/.test(\n    style.overflow + style.overflowX + style.overflowY\n  );\n\n  if (isScrollable && checkForOverflow) {\n    isScrollable =\n      node.scrollHeight !== node.clientHeight ||\n      node.scrollWidth !== node.clientWidth;\n  }\n\n  return isScrollable;\n}\n\nexport function getScrollParent(\n  node: Element,\n  checkForOverflow?: boolean\n): Element {\n  let scrollableNode: Element | null = node;\n\n  if (isScrollable(scrollableNode, checkForOverflow)) {\n    scrollableNode = scrollableNode.parentElement;\n  }\n\n  while (scrollableNode && !isScrollable(scrollableNode, checkForOverflow)) {\n    scrollableNode = scrollableNode.parentElement;\n  }\n\n  return (\n    scrollableNode || document.scrollingElement || document.documentElement\n  );\n}\n\n// HTML input types that do not cause the software keyboard to appear.\nconst nonTextInputTypes = new Set([\n  'checkbox',\n  'radio',\n  'range',\n  'color',\n  'file',\n  'image',\n  'button',\n  'submit',\n  'reset',\n]);\n\n// The number of active usePreventScroll calls. Used to determine whether to revert back to the original page style/scroll position\nlet preventScrollCount = 0;\nlet restore: () => void;\n\n/**\n * Prevents scrolling on the document body on mount, and\n * restores it on unmount. Also ensures that content does not\n * shift due to the scrollbars disappearing.\n */\nexport function usePreventScroll(options: PreventScrollOptions = {}) {\n  const { isDisabled } = options;\n\n  useIsomorphicLayoutEffect(() => {\n    if (isDisabled) {\n      return;\n    }\n\n    preventScrollCount++;\n    if (preventScrollCount === 1) {\n      if (isIOS()) {\n        restore = preventScrollMobileSafari();\n      } else {\n        restore = preventScrollStandard();\n      }\n    }\n\n    return () => {\n      preventScrollCount--;\n      if (preventScrollCount === 0) {\n        restore?.();\n      }\n    };\n  }, [isDisabled]);\n}\n\n// For most browsers, all we need to do is set `overflow: hidden` on the root element, and\n// add some padding to prevent the page from shifting when the scrollbar is hidden.\nfunction preventScrollStandard() {\n  return chain(\n    setStyle(\n      document.documentElement,\n      'paddingRight',\n      `${window.innerWidth - document.documentElement.clientWidth}px`\n    ),\n    setStyle(document.documentElement, 'overflow', 'hidden')\n  );\n}\n\n// Mobile Safari is a whole different beast. Even with overflow: hidden,\n// it still scrolls the page in many situations:\n//\n// 1. When the bottom toolbar and address bar are collapsed, page scrolling is always allowed.\n// 2. When the keyboard is visible, the viewport does not resize. Instead, the keyboard covers part of\n//    it, so it becomes scrollable.\n// 3. When tapping on an input, the page always scrolls so that the input is centered in the visual viewport.\n//    This may cause even fixed position elements to scroll off the screen.\n// 4. When using the next/previous buttons in the keyboard to navigate between inputs, the whole page always\n//    scrolls, even if the input is inside a nested scrollable element that could be scrolled instead.\n//\n// In order to work around these cases, and prevent scrolling without jankiness, we do a few things:\n//\n// 1. Prevent default on `touchmove` events that are not in a scrollable element. This prevents touch scrolling\n//    on the window.\n// 2. Prevent default on `touchmove` events inside a scrollable element when the scroll position is at the\n//    top or bottom. This avoids the whole page scrolling instead, but does prevent overscrolling.\n// 3. Prevent default on `touchend` events on input elements and handle focusing the element ourselves.\n// 4. When focusing an input, apply a transform to trick Safari into thinking the input is at the top\n//    of the page, which prevents it from scrolling the page. After the input is focused, scroll the element\n//    into view ourselves, without scrolling the whole page.\n// 5. Offset the body by the scroll position using a negative margin and scroll to the top. This should appear the\n//    same visually, but makes the actual scroll position always zero. This is required to make all of the\n//    above work or Safari will still try to scroll the page when focusing an input.\n// 6. As a last resort, handle window scroll events, and scroll back to the top. This can happen when attempting\n//    to navigate to an input with the next/previous buttons that's outside a modal.\nfunction preventScrollMobileSafari() {\n  let scrollable: Element | undefined;\n  let lastY = 0;\n\n  const onTouchStart = (e: TouchEvent) => {\n    // Use `composedPath` to support shadow DOM.\n    const target = e.composedPath()?.[0] as HTMLElement;\n\n    // Store the nearest scrollable parent element from the element that the user touched.\n    scrollable = getScrollParent(target, true);\n\n    if (\n      scrollable === document.documentElement &&\n      scrollable === document.body\n    ) {\n      return;\n    }\n\n    lastY = e.changedTouches[0].pageY;\n  };\n\n  const onTouchMove = (e: TouchEvent) => {\n    // In special situations, `onTouchStart` may be called without `onTouchStart` being called.\n    // (e.g. when the user places a finger on the screen before the <Sheet> is mounted and then moves the finger after it is mounted).\n    // If `onTouchStart` is not called, `scrollable` is `undefined`. Therefore, such cases are ignored.\n    if (scrollable === undefined) {\n      return;\n    }\n\n    // Prevent scrolling the window.\n    if (\n      !scrollable ||\n      scrollable === document.documentElement ||\n      scrollable === document.body\n    ) {\n      e.preventDefault();\n      return;\n    }\n\n    // Prevent scrolling up when at the top and scrolling down when at the bottom\n    // of a nested scrollable area, otherwise mobile Safari will start scrolling\n    // the window instead. Unfortunately, this disables bounce scrolling when at\n    // the top but it's the best we can do.\n    const y = e.changedTouches[0].pageY;\n    const scrollTop = scrollable.scrollTop;\n    const bottom = scrollable.scrollHeight - scrollable.clientHeight;\n\n    if (bottom === 0) {\n      return;\n    }\n\n    if ((scrollTop <= 0 && y > lastY) || (scrollTop >= bottom && y < lastY)) {\n      e.preventDefault();\n    }\n\n    lastY = y;\n  };\n\n  const onTouchEnd = (e: TouchEvent) => {\n    // Use `composedPath` to support shadow DOM.\n    const target = e.composedPath()?.[0] as HTMLElement;\n\n    // Apply this change if we're not already focused on the target element\n    if (willOpenKeyboard(target) && target !== document.activeElement) {\n      e.preventDefault();\n\n      // Apply a transform to trick Safari into thinking the input is at the top of the page\n      // so it doesn't try to scroll it into view. When tapping on an input, this needs to\n      // be done before the \"focus\" event, so we have to focus the element ourselves.\n      target.style.transform = 'translateY(-2000px)';\n      target.focus();\n      requestAnimationFrame(() => {\n        target.style.transform = '';\n      });\n    }\n  };\n\n  const onFocus = (e: FocusEvent) => {\n    // Use `composedPath` to support shadow DOM.\n    const target = e.composedPath()?.[0] as HTMLElement;\n\n    if (willOpenKeyboard(target)) {\n      // Transform also needs to be applied in the focus event in cases where focus moves\n      // other than tapping on an input directly, e.g. the next/previous buttons in the\n      // software keyboard. In these cases, it seems applying the transform in the focus event\n      // is good enough, whereas when tapping an input, it must be done before the focus event. \n      target.style.transform = 'translateY(-2000px)';\n      requestAnimationFrame(() => {\n        target.style.transform = '';\n\n        // This will have prevented the browser from scrolling the focused element into view,\n        // so we need to do this ourselves in a way that doesn't cause the whole page to scroll.\n        if (visualViewport) {\n          if (visualViewport.height < window.innerHeight) {\n            // If the keyboard is already visible, do this after one additional frame\n            // to wait for the transform to be removed.\n            requestAnimationFrame(() => {\n              scrollIntoView(target);\n            });\n          } else {\n            // Otherwise, wait for the visual viewport to resize before scrolling so we can\n            // measure the correct position to scroll to.\n            visualViewport.addEventListener(\n              'resize',\n              () => scrollIntoView(target),\n              { once: true }\n            );\n          }\n        }\n      });\n    }\n  };\n\n  const onWindowScroll = () => {\n    // Last resort. If the window scrolled, scroll it back to the top.\n    // It should always be at the top because the body will have a negative margin (see below).\n    window.scrollTo(0, 0);\n  };\n\n  // Record the original scroll position so we can restore it.\n  // Then apply a negative margin to the body to offset it by the scroll position. This will\n  // enable us to scroll the window to the top, which is required for the rest of this to work.\n  const scrollX = window.pageXOffset;\n  const scrollY = window.pageYOffset;\n\n  const restoreStyles = chain(\n    setStyle(\n      document.documentElement,\n      'paddingRight',\n      `${window.innerWidth - document.documentElement.clientWidth}px`\n    ),\n    setStyle(document.documentElement, 'overflow', 'hidden'),\n    setStyle(document.body, 'marginTop', `-${scrollY}px`)\n  );\n\n  // Scroll to the top. The negative margin on the body will make this appear the same.\n  window.scrollTo(0, 0);\n\n  const removeEvents = chain(\n    addEvent(document, 'touchstart', onTouchStart, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'touchmove', onTouchMove, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'touchend', onTouchEnd, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'focus', onFocus, true),\n    addEvent(window, 'scroll', onWindowScroll)\n  );\n\n  return () => {\n    // Restore styles and scroll the page back to where it was.\n    restoreStyles();\n    removeEvents();\n    window.scrollTo(scrollX, scrollY);\n  };\n}\n\n// Sets a CSS property on an element, and returns a function to revert it to the previous value.\nfunction setStyle(element: any, style: string, value: string) {\n  // https://github.com/microsoft/TypeScript/issues/17827#issuecomment-391663310\n  const cur = element.style[style];\n  element.style[style] = value;\n\n  return () => {\n    element.style[style] = cur;\n  };\n}\n\n// Adds an event listener to an element, and returns a function to remove it.\nfunction addEvent<K extends keyof GlobalEventHandlersEventMap>(\n  target: EventTarget,\n  event: K,\n  handler: (this: Document, ev: GlobalEventHandlersEventMap[K]) => any,\n  options?: boolean | AddEventListenerOptions\n) {\n  // @ts-expect-error\n  target.addEventListener(event, handler, options);\n\n  return () => {\n    // @ts-expect-error\n    target.removeEventListener(event, handler, options);\n  };\n}\n\nfunction scrollIntoView(target: Element) {\n  const root = document.scrollingElement || document.documentElement;\n  while (target && target !== root) {\n    // Find the parent scrollable element and adjust the scroll position if the target is not already in view.\n    const scrollable = getScrollParent(target);\n    if (\n      scrollable !== document.documentElement &&\n      scrollable !== document.body &&\n      scrollable !== target\n    ) {\n      const scrollableTop = scrollable.getBoundingClientRect().top;\n      const targetTop = target.getBoundingClientRect().top;\n      const targetBottom = target.getBoundingClientRect().bottom;\n      // Buffer is needed for some edge cases\n      const keyboardHeight =\n        scrollable.getBoundingClientRect().bottom + KEYBOARD_BUFFER;\n\n      if (targetBottom > keyboardHeight) {\n        scrollable.scrollTop += targetTop - scrollableTop;\n      }\n    }\n\n    // @ts-expect-error\n    target = scrollable.parentElement;\n  }\n}\n\nfunction willOpenKeyboard(target: Element) {\n  return (\n    (target instanceof HTMLInputElement &&\n      !nonTextInputTypes.has(target.type)) ||\n    target instanceof HTMLTextAreaElement ||\n    (target instanceof HTMLElement && target.isContentEditable)\n  );\n}\n","import { useCallback, useRef } from 'react';\n\nimport { useIsomorphicLayoutEffect } from './use-isomorphic-layout-effect';\n\nexport function useStableCallback<T extends (...args: any[]) => any>(\n  handler: T\n) {\n  const handlerRef = useRef<T>(undefined);\n\n  useIsomorphicLayoutEffect(() => {\n    handlerRef.current = handler;\n  });\n\n  return useCallback((...args: any[]) => {\n    const fn = handlerRef.current;\n    return fn?.(...args);\n  }, []) as T;\n}\n","import { useEffect, useState } from 'react';\nimport { useStableCallback } from './use-stable-callback';\n\ntype SheetState = 'closed' | 'opening' | 'open' | 'closing';\n\ntype UseSheetStatesProps = {\n  isOpen: boolean;\n  onClosed?: () => Promise<void> | void;\n  onOpening?: () => Promise<void> | void;\n  onOpen?: () => Promise<void> | void;\n  onClosing?: () => Promise<void> | void;\n};\n\nexport function useSheetState({\n  isOpen,\n  onClosed: _onClosed,\n  onOpening: _onOpening,\n  onOpen: _onOpen,\n  onClosing: _onClosing,\n}: UseSheetStatesProps) {\n  const [state, setState] = useState<SheetState>(isOpen ? 'opening' : 'closed');\n  const onClosed = useStableCallback(() => _onClosed?.());\n  const onOpening = useStableCallback(() => _onOpening?.());\n  const onOpen = useStableCallback(() => _onOpen?.());\n  const onClosing = useStableCallback(() => _onClosing?.());\n\n  useEffect(() => {\n    if (isOpen && state === 'closed') {\n      setState('opening');\n    } else if (!isOpen && (state === 'open' || state === 'opening')) {\n      setState('closing');\n    }\n  }, [isOpen, state]);\n\n  useEffect(() => {\n    async function handle() {\n      switch (state) {\n        case 'closed':\n          await onClosed?.();\n          break;\n\n        case 'opening':\n          await onOpening?.();\n          setState('open');\n          break;\n\n        case 'open':\n          await onOpen?.();\n          break;\n\n        case 'closing':\n          await onClosing?.();\n          setState('closed');\n          break;\n      }\n    }\n    handle().catch((error) => {\n      console.error('Internal sheet state error:', error);\n    });\n  }, [state]);\n\n  return state;\n}\n","import { type RefObject, useEffect, useRef, useState } from 'react';\nimport { useStableCallback } from './use-stable-callback';\n\ntype VirtualKeyboardState = {\n  isVisible: boolean;\n  height: number;\n};\n\ntype UseVirtualKeyboardOptions = {\n  /**\n   * Ref to the container element to apply `keyboard-inset-height` CSS variable updates.\n   * @default document.documentElement\n   */\n  containerRef?: RefObject<HTMLElement | null>;\n  /**\n   * Enable or disable the hook entirely.\n   * @default true\n   */\n  isEnabled?: boolean;\n  /**\n   * Minimum pixel height difference to consider the keyboard visible.\n   * @default 100\n   */\n  visualViewportThreshold?: number;\n  /**\n   * Whether to treat contenteditable elements as text inputs.\n   * @default true\n   */\n  includeContentEditable?: boolean;\n  /**\n   * Delay in ms for debouncing viewport changes.\n   * @default 100\n   */\n  debounceDelay?: number;\n};\n\n/**\n * A hook that detects virtual keyboard visibility and height.\n * It listens to focus events and visual viewport changes to determine\n * if a text input is focused and the keyboard is likely visible.\n *\n * It also sets the `--keyboard-inset-height` CSS variable on the specified container\n * (or `:root` by default) to allow for easy styling adjustments when the keyboard is open.\n *\n * @param options Configuration options for the hook.\n * @returns An object containing `isKeyboardOpen` and `keyboardHeight`.\n *\n * @example\n * ```tsx\n * import { useVirtualKeyboard } from 'react-modal-sheet';\n *\n * function MyComponent() {\n *   const { isKeyboardOpen, keyboardHeight } = useVirtualKeyboard();\n *\n *   return (\n *     <div>\n *       <p>Keyboard is {isKeyboardOpen ? 'open' : 'closed'}</p>\n *       <p>Keyboard height: {keyboardHeight}px</p>\n *    </div>\n *  );\n * }\n * ```\n */\nexport function useVirtualKeyboard(options: UseVirtualKeyboardOptions = {}) {\n  const {\n    containerRef,\n    isEnabled = true,\n    debounceDelay = 100,\n    includeContentEditable = true,\n    visualViewportThreshold = 100,\n  } = options;\n\n  const [state, setState] = useState<VirtualKeyboardState>({\n    isVisible: false,\n    height: 0,\n  });\n\n  const focusedElementRef = useRef<HTMLElement | null>(null);\n  const debounceTimer = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const isTextInput = useStableCallback((el: Element | null) => {\n    return (\n      el?.tagName === 'INPUT' ||\n      el?.tagName === 'TEXTAREA' ||\n      (includeContentEditable &&\n        el instanceof HTMLElement &&\n        el.isContentEditable)\n    );\n  });\n\n  useEffect(() => {\n    if (!isEnabled) return;\n\n    const vv = window.visualViewport;\n    const vk = (navigator as any).virtualKeyboard;\n\n    function setKeyboardInsetHeightEnv(height: number) {\n      const element = containerRef?.current || document.documentElement;\n\n      // Virtual Keyboard API is only available in secure context\n      if (window.isSecureContext) {\n        element.style.setProperty(\n          '--keyboard-inset-height',\n          `env(keyboard-inset-height, ${height}px)`\n        );\n      } else {\n        element.style.setProperty('--keyboard-inset-height', `${height}px`);\n      }\n    }\n\n    function handleFocusIn(e: FocusEvent) {\n      if (e.target instanceof HTMLElement && isTextInput(e.target)) {\n        focusedElementRef.current = e.target;\n        updateKeyboardState();\n      }\n    }\n\n    function handleFocusOut() {\n      focusedElementRef.current = null;\n      updateKeyboardState();\n    }\n\n    function updateKeyboardState() {\n      if (debounceTimer.current) {\n        clearTimeout(debounceTimer.current);\n      }\n      debounceTimer.current = setTimeout(() => {\n        const active = focusedElementRef.current;\n        const inputIsFocused = isTextInput(active);\n\n        if (!inputIsFocused) {\n          setKeyboardInsetHeightEnv(0);\n          setState({ isVisible: false, height: 0 });\n          return;\n        }\n\n        if (vv) {\n          const heightDiff = window.innerHeight - vv.height;\n\n          if (heightDiff > visualViewportThreshold) {\n            setKeyboardInsetHeightEnv(heightDiff);\n            setState({ isVisible: true, height: heightDiff });\n          } else {\n            setKeyboardInsetHeightEnv(0);\n            setState({ isVisible: false, height: 0 });\n          }\n        }\n      }, debounceDelay);\n    }\n\n    window.addEventListener('focusin', handleFocusIn);\n    window.addEventListener('focusout', handleFocusOut);\n\n    if (vv) {\n      vv.addEventListener('resize', updateKeyboardState);\n      vv.addEventListener('scroll', updateKeyboardState);\n    }\n\n    let currentOverlaysContent = false;\n\n    if (vk) {\n      currentOverlaysContent = vk.overlaysContent;\n      vk.overlaysContent = true;\n    }\n\n    return () => {\n      window.removeEventListener('focusin', handleFocusIn);\n      window.removeEventListener('focusout', handleFocusOut);\n\n      if (vv) {\n        vv.removeEventListener('resize', updateKeyboardState);\n        vv.removeEventListener('scroll', updateKeyboardState);\n      }\n\n      if (vk) {\n        vk.overlaysContent = currentOverlaysContent;\n      }\n\n      if (debounceTimer.current) {\n        clearTimeout(debounceTimer.current);\n      }\n    };\n  }, [\n    debounceDelay,\n    includeContentEditable,\n    isEnabled,\n    visualViewportThreshold,\n  ]);\n\n  return {\n    keyboardHeight: state.height,\n    isKeyboardOpen: state.isVisible,\n  };\n}\n","import type { SheetSnapPoint } from './types';\nimport { isAscendingOrder } from './utils';\n\n/**\n * Convert negative / percentage snap points to absolute values\n *\n * Example output:\n *\n * ```json\n * [\n *     {\n *         \"snapIndex\": 0, // <-- bottom snap point\n *         \"snapValue\": 0,\n *         \"snapValueY\": 810\n *     },\n *     {\n *         \"snapIndex\": 1,\n *         \"snapValue\": 170,\n *         \"snapValueY\": 640\n *     },\n *     {\n *         \"snapIndex\": 2,\n *         \"snapValue\": 405,\n *         \"snapValueY\": 405\n *     },\n *     {\n *         \"snapIndex\": 3,\n *         \"snapValue\": 760,\n *         \"snapValueY\": 50\n *     },\n *     {\n *         \"snapIndex\": 4, // <-- top snap point\n *         \"snapValue\": 810,\n *         \"snapValueY\": 0\n *     }\n * ]\n * ```\n */\nexport function computeSnapPoints({\n  snapPointsProp,\n  sheetHeight,\n}: {\n  snapPointsProp: number[];\n  sheetHeight: number;\n}): SheetSnapPoint[] {\n  if (snapPointsProp[0] !== 0) {\n    console.error(\n      'First snap point should be 0 to ensure the sheet can be fully closed. ' +\n        `Got: [${snapPointsProp.join(', ')}]`\n    );\n    snapPointsProp.unshift(0);\n  }\n\n  if (snapPointsProp[snapPointsProp.length - 1] !== 1) {\n    console.error(\n      'Last snap point should be 1 to ensure the sheet can be fully opened. ' +\n        `Got: [${snapPointsProp.join(', ')}]`\n    );\n    snapPointsProp.push(1);\n  }\n\n  if (sheetHeight <= 0) {\n    console.error(\n      `Sheet height is ${sheetHeight}, cannot compute snap points. ` +\n        'Make sure the sheet is mounted and has a valid height.'\n    );\n    return [];\n  }\n\n  const snapPointValues = snapPointsProp.map((point) => {\n    // Percentage values e.g. between 0.0 and 1.0\n    if (point > 0 && point <= 1) {\n      return Math.round(point * sheetHeight);\n    }\n\n    return point < 0 ? sheetHeight + point : point; // negative values\n  });\n\n  console.assert(\n    isAscendingOrder(snapPointValues),\n    `Snap points need to be in ascending order got: [${snapPointsProp.join(', ')}]`\n  );\n\n  // Make sure all snap points are within the sheet height\n  snapPointValues.forEach((snap) => {\n    if (snap < 0 || snap > sheetHeight) {\n      console.warn(\n        `Snap point ${snap} is outside of the sheet height ${sheetHeight}. ` +\n          'This can cause unexpected behavior. Consider adjusting your snap points.'\n      );\n    }\n  });\n\n  if (!snapPointValues.includes(sheetHeight)) {\n    console.warn(\n      'Snap points do not include the sheet height.' +\n        'Please include `1` as the last snap point or it will be included automatically.' +\n        'This is to ensure the sheet can be fully opened.'\n    );\n    snapPointValues.push(sheetHeight);\n  }\n\n  return snapPointValues.map((snap, index) => ({\n    snapIndex: index,\n    snapValue: snap, // Absolute value from the bottom of the sheet\n    snapValueY: sheetHeight - snap, // Y value is inverted as `y = 0` means sheet is at the top\n  }));\n}\n\nfunction findClosestSnapPoint({\n  snapPoints,\n  currentY,\n}: {\n  snapPoints: SheetSnapPoint[];\n  currentY: number;\n}) {\n  return snapPoints.reduce((closest, snap) =>\n    Math.abs(snap.snapValueY - currentY) <\n    Math.abs(closest.snapValueY - currentY)\n      ? snap\n      : closest\n  );\n}\n\nfunction findNextSnapPointInDirection({\n  y,\n  snapPoints,\n  dragDirection,\n}: {\n  y: number;\n  snapPoints: SheetSnapPoint[];\n  dragDirection: 'up' | 'down';\n}) {\n  // NOTE: lower Y means higher in the sheet position!\n  if (dragDirection === 'down') {\n    /**\n     * Example:\n     *\n     * [\n     *   { snapIndex: 0, snapValueY: 810 },\n     *   { snapIndex: 1, snapValueY: 640 },\n     *   { snapIndex: 2, snapValueY: 405 }, <-- next down\n     *   ------------- Y = 60 ------------\n     *   { snapIndex: 3, snapValueY: 50 },\n     *   { snapIndex: 4, snapValueY: 0 },\n     * ]\n     */\n    return snapPoints\n      .slice()\n      .reverse()\n      .find((s) => s.snapValueY > y);\n  } else {\n    /**\n     * Example:\n     * [\n     *   { snapIndex: 0, snapValueY: 810 },\n     *   { snapIndex: 1, snapValueY: 640 },\n     *   { snapIndex: 2, snapValueY: 405 },\n     *   ------------- Y = 60 ------------\n     *   { snapIndex: 3, snapValueY: 50 }, <-- next up\n     *   { snapIndex: 4, snapValueY: 0 },\n     * ]\n     */\n    return snapPoints.find((s) => s.snapValueY < y);\n  }\n}\nexport function handleHighVelocityDrag({\n  dragDirection,\n  snapPoints,\n}: {\n  dragDirection: 'up' | 'down';\n  snapPoints: SheetSnapPoint[];\n}) {\n  // Go to either the last or the first snap point depending on the direction\n  const bottomSnapPoint = snapPoints[0];\n  const topSnapPoint = snapPoints[snapPoints.length - 1];\n\n  if (dragDirection === 'down') {\n    return {\n      yTo: bottomSnapPoint.snapValueY,\n      snapIndex: bottomSnapPoint.snapIndex,\n    };\n  }\n  return {\n    yTo: topSnapPoint.snapValueY,\n    snapIndex: topSnapPoint.snapIndex,\n  };\n}\n\nexport function handleLowVelocityDrag({\n  currentSnapPoint,\n  currentY,\n  dragDirection,\n  snapPoints,\n  velocity,\n}: {\n  currentSnapPoint: SheetSnapPoint;\n  currentY: number;\n  dragDirection: 'up' | 'down';\n  snapPoints: SheetSnapPoint[];\n  velocity: number;\n}) {\n  const closestSnapRelativeToCurrentY = findClosestSnapPoint({\n    snapPoints,\n    currentY,\n  });\n\n  /**\n   * If velocity is very low the user has stopped the sheet to a specific\n   * position and we should snap to the closest snap point as there is no\n   * \"momentum\" that would push the sheet further to the given direction\n   */\n  if (Math.abs(velocity) < 20) {\n    return {\n      yTo: closestSnapRelativeToCurrentY.snapValueY,\n      snapIndex: closestSnapRelativeToCurrentY.snapIndex,\n    };\n  }\n\n  /**\n   * If the dragging has a bit more velocity, we instead want to go to\n   * the next snap point in the given direction if it exists\n   */\n  const nextSnapInDirectionRelativeToCurrentY = findNextSnapPointInDirection({\n    y: currentY,\n    snapPoints,\n    dragDirection,\n  });\n\n  if (nextSnapInDirectionRelativeToCurrentY) {\n    return {\n      yTo: nextSnapInDirectionRelativeToCurrentY.snapValueY,\n      snapIndex: nextSnapInDirectionRelativeToCurrentY.snapIndex,\n    };\n  }\n\n  // No snap point down, stay at current\n  return {\n    yTo: currentSnapPoint.snapValueY,\n    snapIndex: currentSnapPoint.snapIndex,\n  };\n}\n","import {\n  animate,\n  type DragHandler,\n  motion,\n  type Transition,\n  useMotionValue,\n  useReducedMotion,\n  useTransform,\n} from 'motion/react';\nimport React, {\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport useMeasure from 'react-use-measure';\n\nimport {\n  DEFAULT_DRAG_CLOSE_THRESHOLD,\n  DEFAULT_DRAG_VELOCITY_THRESHOLD,\n  DEFAULT_TWEEN_CONFIG,\n  IS_SSR,\n  REDUCED_MOTION_TWEEN_CONFIG,\n} from './constants';\nimport { SheetContext } from './context';\nimport { useDimensions } from './hooks/use-dimensions';\nimport { useModalEffect } from './hooks/use-modal-effect';\nimport { usePreventScroll } from './hooks/use-prevent-scroll';\nimport { useSheetState } from './hooks/use-sheet-state';\nimport { useStableCallback } from './hooks/use-stable-callback';\nimport { useVirtualKeyboard } from './hooks/use-virtual-keyboard';\nimport {\n  computeSnapPoints,\n  handleHighVelocityDrag,\n  handleLowVelocityDrag,\n} from './snap';\nimport { styles } from './styles';\nimport { type SheetContextType, type SheetProps } from './types';\nimport { applyStyles, waitForElement } from './utils';\n\nexport const Sheet = forwardRef<any, SheetProps>(\n  (\n    {\n      avoidKeyboard = true,\n      children,\n      className = '',\n      detent = 'default',\n      disableDismiss = false,\n      disableDrag: disableDragProp = false,\n      disableScrollLocking = false,\n      dragCloseThreshold = DEFAULT_DRAG_CLOSE_THRESHOLD,\n      dragVelocityThreshold = DEFAULT_DRAG_VELOCITY_THRESHOLD,\n      initialSnap,\n      isOpen,\n      modalEffectRootId,\n      modalEffectThreshold,\n      mountPoint,\n      prefersReducedMotion = false,\n      snapPoints: snapPointsProp,\n      style,\n      tweenConfig = DEFAULT_TWEEN_CONFIG,\n      unstyled = false,\n      onOpenStart,\n      onOpenEnd,\n      onClose,\n      onCloseStart,\n      onCloseEnd,\n      onSnap,\n      onDrag: onDragProp,\n      onDragStart: onDragStartProp,\n      onDragEnd: onDragEndProp,\n      ...rest\n    },\n    ref\n  ) => {\n    const [sheetBoundsRef, sheetBounds] = useMeasure();\n    const sheetRef = useRef<HTMLDivElement>(null);\n    const sheetHeight = Math.round(sheetBounds.height);\n    const [currentSnap, setCurrentSnap] = useState(initialSnap);\n    const snapPoints =\n      snapPointsProp && sheetHeight > 0\n        ? computeSnapPoints({ sheetHeight, snapPointsProp })\n        : [];\n\n    const { windowHeight } = useDimensions();\n    const closedY = sheetHeight > 0 ? sheetHeight : windowHeight;\n    const y = useMotionValue(closedY);\n    const yInverted = useTransform(y, (val) => Math.max(sheetHeight - val, 0));\n    const indicatorRotation = useMotionValue(0);\n\n    const shouldReduceMotion = useReducedMotion();\n    const reduceMotion = Boolean(prefersReducedMotion || shouldReduceMotion);\n    const animationOptions: Transition = {\n      type: 'tween',\n      ...(reduceMotion ? REDUCED_MOTION_TWEEN_CONFIG : tweenConfig),\n    };\n\n    const keyboard = useVirtualKeyboard({\n      isEnabled: isOpen && avoidKeyboard,\n      containerRef: sheetRef,\n    });\n\n    // Disable drag if the keyboard is open to avoid weird behavior\n    const disableDrag = keyboard.isKeyboardOpen || disableDragProp;\n\n    // +2 for tolerance in case the animated value is slightly off\n    const zIndex = useTransform(y, (val) =>\n      val + 2 >= closedY ? -1 : (style?.zIndex ?? 9999)\n    );\n    const visibility = useTransform(y, (val) =>\n      val + 2 >= closedY ? 'hidden' : 'visible'\n    );\n\n    const updateSnap = useStableCallback((snapIndex: number) => {\n      setCurrentSnap(snapIndex);\n      onSnap?.(snapIndex);\n    });\n\n    const getSnapPoint = useStableCallback((snapIndex: number) => {\n      if (snapPointsProp && snapPoints) {\n        if (snapIndex < 0 || snapIndex >= snapPoints.length) {\n          console.warn(\n            `Invalid snap index ${snapIndex}. Snap points are: [${snapPointsProp.join(', ')}] and their computed values are: [${snapPoints\n              .map((point) => point.snapValue)\n              .join(', ')}]`\n          );\n          return null;\n        }\n        return snapPoints[snapIndex];\n      }\n      return null;\n    });\n\n    const snapTo = useStableCallback(async (snapIndex: number) => {\n      if (!snapPointsProp) {\n        console.warn('Snapping is not possible without `snapPoints` prop.');\n        return;\n      }\n\n      const snapPoint = getSnapPoint(snapIndex);\n\n      if (snapPoint === null) {\n        console.warn(`Invalid snap index ${snapIndex}.`);\n        return;\n      }\n\n      if (snapIndex === 0) {\n        onClose();\n        return;\n      }\n\n      await animate(y, snapPoint.snapValueY, {\n        ...animationOptions,\n        onComplete: () => updateSnap(snapIndex),\n      });\n    });\n\n    const blurActiveInput = useStableCallback(() => {\n      // Find focused input inside the sheet and blur it when dragging starts\n      // to prevent a weird ghost caret \"bug\" on mobile\n      const focusedElement = document.activeElement as HTMLElement | null;\n      if (!focusedElement || !sheetRef.current) return;\n\n      const isInput =\n        focusedElement.tagName === 'INPUT' ||\n        focusedElement.tagName === 'TEXTAREA';\n\n      // Only blur the focused element if it's inside the sheet\n      if (isInput && sheetRef.current.contains(focusedElement)) {\n        focusedElement.blur();\n      }\n    });\n\n    const onDrag = useStableCallback<DragHandler>((event, info) => {\n      onDragProp?.(event, info);\n\n      const currentY = y.get();\n\n      // Update drag indicator rotation based on drag velocity\n      const velocity = y.getVelocity();\n      if (velocity > 0) indicatorRotation.set(10);\n      if (velocity < 0) indicatorRotation.set(-10);\n\n      // Make sure user cannot drag beyond the top of the sheet\n      y.set(Math.max(currentY + info.delta.y, 0));\n    });\n\n    const onDragStart = useStableCallback<DragHandler>((event, info) => {\n      blurActiveInput();\n      onDragStartProp?.(event, info);\n    });\n\n    const onDragEnd = useStableCallback<DragHandler>((event, info) => {\n      blurActiveInput();\n      onDragEndProp?.(event, info);\n\n      const currentY = y.get();\n\n      let yTo = 0;\n\n      const currentSnapPoint =\n        currentSnap !== undefined ? getSnapPoint(currentSnap) : null;\n\n      if (currentSnapPoint) {\n        const dragOffsetDirection = info.offset.y > 0 ? 'down' : 'up';\n        const dragVelocityDirection = info.velocity.y > 0 ? 'down' : 'up';\n        const isHighVelocity =\n          Math.abs(info.velocity.y) > dragVelocityThreshold;\n\n        let result: { yTo: number; snapIndex: number | undefined };\n\n        if (isHighVelocity) {\n          result = handleHighVelocityDrag({\n            snapPoints,\n            dragDirection: dragVelocityDirection,\n          });\n        } else {\n          result = handleLowVelocityDrag({\n            currentSnapPoint,\n            currentY,\n            dragDirection: dragOffsetDirection,\n            snapPoints,\n            velocity: info.velocity.y,\n          });\n        }\n\n        yTo = result.yTo;\n\n        // If disableDismiss is true, prevent closing via gesture\n        if (disableDismiss && yTo + 1 >= sheetHeight) {\n          // Use the bottom-most open snap point\n          const bottomSnapPoint = snapPoints.find((s) => s.snapValue > 0);\n\n          if (bottomSnapPoint) {\n            yTo = bottomSnapPoint.snapValueY;\n            updateSnap(bottomSnapPoint.snapIndex);\n          } else {\n            // If no open snap points available, stay at current position\n            yTo = currentY;\n          }\n        } else if (result.snapIndex !== undefined) {\n          updateSnap(result.snapIndex);\n        }\n      } else if (\n        info.velocity.y > dragVelocityThreshold ||\n        currentY > sheetHeight * dragCloseThreshold\n      ) {\n        // Close the sheet if dragged past the threshold or if the velocity is high enough\n        // But only if disableDismiss is false\n        if (disableDismiss) {\n          // If disableDismiss, snap back to the open position\n          yTo = 0;\n        } else {\n          yTo = closedY;\n        }\n      }\n\n      // Update the spring value so that the sheet is animated to the snap point\n      animate(y, yTo, animationOptions);\n\n      // +1px for imprecision tolerance\n      // Only call onClose if disableDismiss is false or if we're actually closing\n      if (yTo + 1 >= sheetHeight && !disableDismiss) {\n        onClose();\n      }\n\n      // Reset indicator rotation after dragging\n      indicatorRotation.set(0);\n    });\n\n    useImperativeHandle(ref, () => ({\n      y,\n      yInverted,\n      height: sheetHeight,\n      snapTo,\n    }));\n\n    useModalEffect({\n      y,\n      detent,\n      sheetHeight,\n      snapPoints,\n      rootId: modalEffectRootId,\n      startThreshold: modalEffectThreshold,\n    });\n\n    /**\n     * Motion should handle body scroll locking but it's not working properly on iOS.\n     * Scroll locking from React Aria seems to work much better \n     */\n    usePreventScroll({\n      isDisabled: disableScrollLocking || !isOpen,\n    });\n\n    const state = useSheetState({\n      isOpen,\n      onOpen: async () => {\n        onOpenStart?.();\n\n        /**\n         * This is not very React-y but we need to wait for the sheet\n         * but we need to wait for the sheet to be rendered and visible\n         * before we can measure it and animate it to the initial snap point.\n         */\n        await waitForElement('react-modal-sheet-container');\n\n        const initialSnapPoint =\n          initialSnap !== undefined ? getSnapPoint(initialSnap) : null;\n\n        const yTo = initialSnapPoint?.snapValueY ?? 0;\n\n        await animate(y, yTo, animationOptions);\n\n        if (initialSnap !== undefined) {\n          updateSnap(initialSnap);\n        }\n\n        onOpenEnd?.();\n      },\n      onClosing: async () => {\n        onCloseStart?.();\n\n        await animate(y, closedY, animationOptions);\n\n        onCloseEnd?.();\n      },\n    });\n\n    const dragProps: SheetContextType['dragProps'] = {\n      drag: 'y',\n      dragElastic: 0,\n      dragMomentum: false,\n      dragPropagation: false,\n      onDrag,\n      onDragStart,\n      onDragEnd,\n    };\n\n    const context: SheetContextType = {\n      currentSnap,\n      detent,\n      disableDrag,\n      dragProps,\n      indicatorRotation,\n      avoidKeyboard,\n      sheetBoundsRef,\n      sheetRef,\n      unstyled,\n      y,\n    };\n\n    const sheet = (\n      <SheetContext.Provider value={context}>\n        <motion.div\n          {...rest}\n          ref={ref}\n          data-sheet-state={state}\n          className={`react-modal-sheet-root ${className}`}\n          style={{\n            ...applyStyles(styles.root, unstyled),\n            zIndex,\n            visibility,\n            ...style,\n          }}\n        >\n          {state !== 'closed' ? children : null}\n        </motion.div>\n      </SheetContext.Provider>\n    );\n\n    if (IS_SSR) return sheet;\n\n    return createPortal(sheet, mountPoint ?? document.body);\n  }\n);\n\nSheet.displayName = 'Sheet';\n","import type { MotionValue } from 'motion/react';\n\nimport { SheetBackdrop } from './SheetBackdrop';\nimport { SheetContainer } from './SheetContainer';\nimport { SheetContent } from './SheetContent';\nimport { SheetDragIndicator } from './SheetDragIndicator';\nimport { SheetHeader } from './SheetHeader';\nimport { Sheet as SheetBase } from './sheet';\nimport type { SheetCompound } from './types';\n\nexport interface SheetRef {\n  y: MotionValue<number>;\n  yInverted: MotionValue<number>;\n  height: number;\n  snapTo: (index: number) => Promise<void>;\n}\n\nexport const Sheet: SheetCompound = Object.assign(SheetBase, {\n  Container: SheetContainer,\n  Header: SheetHeader,\n  DragIndicator: SheetDragIndicator,\n  Content: SheetContent,\n  Backdrop: SheetBackdrop,\n});\n\nexport { useScrollPosition } from './hooks/use-scroll-position';\nexport { useVirtualKeyboard } from './hooks/use-virtual-keyboard';\n\n// Export types\nexport type {\n  SheetBackdropProps,\n  SheetContainerProps,\n  SheetContentProps,\n  SheetDetent,\n  SheetDragIndicatorProps,\n  SheetHeaderProps,\n  SheetProps,\n  SheetSnapPoint,\n  SheetStateInfo,\n  SheetTweenConfig,\n} from './types';\n"]}